<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.54">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>pgbench_tutorial</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="pgbench_tutorial_files/libs/clipboard/clipboard.min.js"></script>
<script src="pgbench_tutorial_files/libs/quarto-html/quarto.js"></script>
<script src="pgbench_tutorial_files/libs/quarto-html/popper.min.js"></script>
<script src="pgbench_tutorial_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="pgbench_tutorial_files/libs/quarto-html/anchor.min.js"></script>
<link href="pgbench_tutorial_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="pgbench_tutorial_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="pgbench_tutorial_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="pgbench_tutorial_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="pgbench_tutorial_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link rel="icon" href="data:,">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#postgres-extras-clj-example-with-pgbench" id="toc-postgres-extras-clj-example-with-pgbench" class="nav-link active" data-scroll-target="#postgres-extras-clj-example-with-pgbench"><code>postgres-extras-clj</code> example with pgbench</a>
  <ul>
  <li><a href="#utility-functions" id="toc-utility-functions" class="nav-link" data-scroll-target="#utility-functions">Utility functions</a></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a>
  <ul class="collapse">
  <li><a href="#dependencies" id="toc-dependencies" class="nav-link" data-scroll-target="#dependencies">Dependencies</a></li>
  <li><a href="#database-benchmark" id="toc-database-benchmark" class="nav-link" data-scroll-target="#database-benchmark">Database benchmark</a></li>
  <li><a href="#driver-setup" id="toc-driver-setup" class="nav-link" data-scroll-target="#driver-setup">Driver Setup</a></li>
  </ul></li>
  <li><a href="#settings-at-a-glance" id="toc-settings-at-a-glance" class="nav-link" data-scroll-target="#settings-at-a-glance">Settings at a glance</a></li>
  <li><a href="#full-map-of-database-objects-the-data-dictionary" id="toc-full-map-of-database-objects-the-data-dictionary" class="nav-link" data-scroll-target="#full-map-of-database-objects-the-data-dictionary">Full map of database objects, the “data dictionary”</a>
  <ul class="collapse">
  <li><a href="#list-all-databases" id="toc-list-all-databases" class="nav-link" data-scroll-target="#list-all-databases">List all databases</a></li>
  <li><a href="#list-all-shemas-in-current-database" id="toc-list-all-shemas-in-current-database" class="nav-link" data-scroll-target="#list-all-shemas-in-current-database">List all shemas in current database</a></li>
  <li><a href="#list-all-view-objects-in-current-database" id="toc-list-all-view-objects-in-current-database" class="nav-link" data-scroll-target="#list-all-view-objects-in-current-database">List all view objects in current database</a></li>
  <li><a href="#list-all-index-objects-in-current-database" id="toc-list-all-index-objects-in-current-database" class="nav-link" data-scroll-target="#list-all-index-objects-in-current-database">List all index objects in current database</a></li>
  <li><a href="#list-all-database-column-objects" id="toc-list-all-database-column-objects" class="nav-link" data-scroll-target="#list-all-database-column-objects">List all database column objects</a></li>
  <li><a href="#list-all-table-objects-in-current-database" id="toc-list-all-table-objects-in-current-database" class="nav-link" data-scroll-target="#list-all-table-objects-in-current-database">List all table objects in current database</a></li>
  <li><a href="#list-all-function-objects-in-current-database" id="toc-list-all-function-objects-in-current-database" class="nav-link" data-scroll-target="#list-all-function-objects-in-current-database">List all function objects in current database</a></li>
  </ul></li>
  <li><a href="#full-map-of-diagnostic-statistics" id="toc-full-map-of-diagnostic-statistics" class="nav-link" data-scroll-target="#full-map-of-diagnostic-statistics">Full map of diagnostic statistics</a>
  <ul class="collapse">
  <li><a href="#dead-rows-and-whether-an-automatic-vacuum-is-expected-to-be-triggered" id="toc-dead-rows-and-whether-an-automatic-vacuum-is-expected-to-be-triggered" class="nav-link" data-scroll-target="#dead-rows-and-whether-an-automatic-vacuum-is-expected-to-be-triggered">Dead rows and whether an automatic vacuum is expected to be triggered</a></li>
  <li><a href="#index-hit-rate-effective-databases-are-at-99-and-up" id="toc-index-hit-rate-effective-databases-are-at-99-and-up" class="nav-link" data-scroll-target="#index-hit-rate-effective-databases-are-at-99-and-up">Index hit rate (effective databases are at 99% and up)</a></li>
  <li><a href="#total-size-of-all-indexes-in-mb" id="toc-total-size-of-all-indexes-in-mb" class="nav-link" data-scroll-target="#total-size-of-all-indexes-in-mb">Total size of all indexes in MB</a></li>
  <li><a href="#index-and-table-hit-rate" id="toc-index-and-table-hit-rate" class="nav-link" data-scroll-target="#index-and-table-hit-rate">Index and table hit rate</a></li>
  <li><a href="#all-tables-and-the-number-of-rows-in-each-ordered-by-number-of-rows-descending" id="toc-all-tables-and-the-number-of-rows-in-each-ordered-by-number-of-rows-descending" class="nav-link" data-scroll-target="#all-tables-and-the-number-of-rows-in-each-ordered-by-number-of-rows-descending">All tables and the number of rows in each ordered by number of rows descending</a></li>
  <li><a href="#calculates-your-cache-hit-rate-for-reading-indexes" id="toc-calculates-your-cache-hit-rate-for-reading-indexes" class="nav-link" data-scroll-target="#calculates-your-cache-hit-rate-for-reading-indexes">Calculates your cache hit rate for reading indexes</a></li>
  <li><a href="#queries-that-have-longest-execution-time-in-aggregate." id="toc-queries-that-have-longest-execution-time-in-aggregate." class="nav-link" data-scroll-target="#queries-that-have-longest-execution-time-in-aggregate.">Queries that have longest execution time in aggregate.</a></li>
  <li><a href="#available-and-installed-extensions" id="toc-available-and-installed-extensions" class="nav-link" data-scroll-target="#available-and-installed-extensions">Available and installed extensions</a></li>
  <li><a href="#size-of-the-tables-including-indexes-descending-by-size" id="toc-size-of-the-tables-including-indexes-descending-by-size" class="nav-link" data-scroll-target="#size-of-the-tables-including-indexes-descending-by-size">Size of the tables (including indexes), descending by size</a></li>
  <li><a href="#table-and-index-bloat-in-your-database-ordered-by-most-wasteful" id="toc-table-and-index-bloat-in-your-database-ordered-by-most-wasteful" class="nav-link" data-scroll-target="#table-and-index-bloat-in-your-database-ordered-by-most-wasteful">Table and index bloat in your database ordered by most wasteful</a></li>
  <li><a href="#queries-that-have-the-highest-frequency-of-execution" id="toc-queries-that-have-the-highest-frequency-of-execution" class="nav-link" data-scroll-target="#queries-that-have-the-highest-frequency-of-execution">Queries that have the highest frequency of execution</a></li>
  <li><a href="#size-of-the-tables-excluding-indexes-descending-by-size" id="toc-size-of-the-tables-excluding-indexes-descending-by-size" class="nav-link" data-scroll-target="#size-of-the-tables-excluding-indexes-descending-by-size">Size of the tables (excluding indexes), descending by size</a></li>
  <li><a href="#returns-the-list-of-all-active-database-connections" id="toc-returns-the-list-of-all-active-database-connections" class="nav-link" data-scroll-target="#returns-the-list-of-all-active-database-connections">Returns the list of all active database connections</a></li>
  <li><a href="#calculates-your-cache-hit-rate-for-reading-tables" id="toc-calculates-your-cache-hit-rate-for-reading-tables" class="nav-link" data-scroll-target="#calculates-your-cache-hit-rate-for-reading-tables">Calculates your cache hit rate for reading tables</a></li>
  <li><a href="#total-size-of-all-the-indexes-on-each-table-descending-by-size" id="toc-total-size-of-all-the-indexes-on-each-table-descending-by-size" class="nav-link" data-scroll-target="#total-size-of-all-the-indexes-on-each-table-descending-by-size">Total size of all the indexes on each table, descending by size</a></li>
  <li><a href="#count-of-sequential-scans-by-table-descending-by-order" id="toc-count-of-sequential-scans-by-table-descending-by-order" class="nav-link" data-scroll-target="#count-of-sequential-scans-by-table-descending-by-order">Count of sequential scans by table descending by order</a></li>
  <li><a href="#the-size-of-indexes-descending-by-size" id="toc-the-size-of-indexes-descending-by-size" class="nav-link" data-scroll-target="#the-size-of-indexes-descending-by-size">The size of indexes, descending by size</a></li>
  </ul></li>
  <li><a href="#the-kill-switch" id="toc-the-kill-switch" class="nav-link" data-scroll-target="#the-kill-switch">The Kill Switch</a></li>
  <li><a href="#diagnostics" id="toc-diagnostics" class="nav-link" data-scroll-target="#diagnostics">Diagnostics</a></li>
  <li><a href="#just-for-fun" id="toc-just-for-fun" class="nav-link" data-scroll-target="#just-for-fun">Just for fun</a></li>
  <li><a href="#to-recreate-this-notebook" id="toc-to-recreate-this-notebook" class="nav-link" data-scroll-target="#to-recreate-this-notebook">To recreate this notebook</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">




<style></style>
<style>.printedClojure .sourceCode {
  background-color: transparent;
  border-style: none;
}
</style>
<style>.clay-limit-image-width .clay-image {max-width: 100%}
</style>
<script src="pgbench_tutorial_files/md-default0.js" type="text/javascript"></script>
<script src="pgbench_tutorial_files/md-default1.js" type="text/javascript"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js" type="text/javascript"></script>
<p><link href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" type="text/css"></p>
<section id="postgres-extras-clj-example-with-pgbench" class="level1">
<h1><code>postgres-extras-clj</code> example with pgbench</h1>
<p><code>postgres-extras-clj</code> is a Clojure toolbox for inspecting and diagnosing PostgreSQL databases.</p>
<ul>
<li><a href="https://clojars.org/com.github.perrygeo/postgres-extras-clj">Clojars</a></li>
<li><a href="https://github.com/perrygeo/postgres-extras-clj">Github</a></li>
<li><a href="https://cljdoc.org/d/com.github.perrygeo/postgres-extras-clj/">Documentation</a></li>
<li><a href="https://github.com/perrygeo/postgres-extras-clj/actions/workflows/test.yml">CI tests</a></li>
</ul>
<p>In this notebook, we’ll cover the majority of the high-level API, demonstrating some useful fns based on the postgres <a href="https://www.postgresql.org/docs/current/catalogs.html">system catalogs</a>.</p>
<p>This notebook is written in a <a href="https://github.com/perrygeo/postgres-extras-clj/blob/main/examples/pgbench_tutorial.clj">Clojure namespace</a> and converted to HTML using <a href="https://scicloj.github.io/clay/#api">Clay</a>.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb1"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">ns</span> pgbench-tutorial</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"This is a demonstration of postgres-extras-clj using the next.jdbc adapter</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="st">  to access a pgbench database."</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  (<span class="at">:require</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>   [hugsql.adapter.next-jdbc <span class="at">:as</span> next-adapter]</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>   [hugsql.core <span class="at">:as</span> hugsql]</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>   [<span class="kw">next</span>.jdbc <span class="at">:as</span> jdbc]</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>   [postgres-extras-clj.core <span class="at">:as</span> pgex]</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>   [scicloj.kindly.v4.kind <span class="at">:as</span> kind]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="utility-functions" class="level2">
<h2 class="anchored" data-anchor-id="utility-functions">Utility functions</h2>
<div class="sourceClojure">
<div class="sourceCode" id="cb2"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defn</span><span class="fu"> show</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Given a sequence of maps (records),</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="st">  Kindly show me a table with some nice UI elements."</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  [f]</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">if</span> (<span class="kw">empty?</span> f)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    '()</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    (<span class="kw">let</span> [ncol (<span class="kw">count</span> (<span class="kw">first</span> f))</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>          nrow (<span class="kw">count</span> f)]</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>      (kind/table f</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>                  {<span class="at">:use-datatables</span> <span class="va">true</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">:datatables</span> {<span class="at">:paging</span> (<span class="kw">&lt;</span> <span class="dv">12</span> nrow)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>                                <span class="at">:scrollY</span> <span class="va">false</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>                                <span class="at">:scrollX</span> (<span class="kw">&lt;</span> <span class="dv">6</span> ncol)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>                                <span class="at">:pageLength</span> <span class="dv">12</span>}}))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb3"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defn</span><span class="fu"> show-public</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Given a sequence of maps (records), </span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="st">  filter for non-system objects, then show it."</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  [f]</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  (show</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>   (<span class="kw">filter</span> #(<span class="kw">not</span> (<span class="at">:system</span>_object <span class="va">%</span>)) f)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<section id="dependencies" class="level3">
<h3 class="anchored" data-anchor-id="dependencies">Dependencies</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a> {<span class="at">:deps</span> {com.layerware/hugsql {<span class="at">:mvn/version</span> <span class="st">"0.5.3"</span>}</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>         com.layerware/hugsql-adapter-next-jdbc {<span class="at">:mvn/version</span> <span class="st">"0.5.3"</span>}</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>         org.scicloj/clay {<span class="at">:mvn/version</span> <span class="st">"2-beta11"</span>}</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>         org.postgresql/postgresql {<span class="at">:mvn/version</span> <span class="st">"42.7.3"</span>}</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>         seancorfield/next.jdbc {<span class="at">:mvn/version</span> <span class="st">"1.2.659"</span>}}}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="database-benchmark" class="level3">
<h3 class="anchored" data-anchor-id="database-benchmark">Database benchmark</h3>
<p>We’ll use <a href="https://www.postgresql.org/docs/current/pgbench.html"><code>pgbench</code></a> to get a database populated with interesting tables:</p>
<blockquote class="blockquote">
<p>Pgbench is a simple program for running benchmark tests on PostgreSQL. It runs the same sequence of SQL commands over and over, possibly in multiple concurrent database sessions, and then calculates the average transaction rate (transactions per second) . By default, pgbench tests a scenario that is loosely based on TPC-B, involving five SELECT, UPDATE, and INSERT commands per transaction.</p>
</blockquote>
<p>To initialize</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a> <span class="va">PGPASSWORD</span><span class="op">=</span>password <span class="ex">pgbench</span> <span class="at">--host</span> localhost <span class="at">--port</span> 5432 <span class="at">--username</span> postgres <span class="at">-s</span> 10 <span class="at">-F</span> 100 <span class="at">-i</span> <span class="at">-I</span> dtgvpf main</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Then run the benchmarks</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a> <span class="va">PGPASSWORD</span><span class="op">=</span>password <span class="ex">pgbench</span> <span class="at">--host</span> localhost <span class="at">--port</span> 5432 <span class="at">--username</span> postgres <span class="at">--client</span> 32 <span class="at">--transactions</span> 1000 <span class="at">--jobs</span> 8 main</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="driver-setup" class="level3">
<h3 class="anchored" data-anchor-id="driver-setup">Driver Setup</h3>
<p>We define a JDBC datasource from a map</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb7"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> db</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  (jdbc/get-datasource</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>   {<span class="at">:dbtype</span> <span class="st">"postgresql"</span> <span class="at">:dbname</span> <span class="st">"main"</span> <span class="at">:host</span> <span class="st">"localhost"</span> <span class="at">:port</span> <span class="dv">5432</span> <span class="at">:user</span> <span class="st">"postgres"</span> <span class="at">:password</span> <span class="st">"password"</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>or from a JDBC URI.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb8"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> db2</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  (jdbc/get-datasource</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>   <span class="st">"jdbc:postgresql://localhost:5432/main?user=postgres&amp;password=password"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Independently, we need to tell hugsql to expect next-jdbc.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb9"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>(hugsql/set-adapter! (next-adapter/hugsql-adapter-next-jdbc))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb10"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>#object[hugsql.adapter.next_jdbc.HugsqlAdapterNextJdbc <span class="bn">0x161ec66b</span> <span class="st">"hugsql.adapter.next_jdbc.HugsqlAdapterNextJdbc@161ec66b"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Do a health check to ensure connectivity</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb11"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>(pgex/health-check db)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb12"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:now</span> #inst <span class="st">"2024-07-11T15:09:50.237955000-00:00"</span>,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:version</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a> <span class="st">"PostgreSQL 16.2 (Debian 16.2-1.pgdg110+2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 10.2.1-6) 10.2.1 20210110, 64-bit"</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="settings-at-a-glance" class="level2">
<h2 class="anchored" data-anchor-id="settings-at-a-glance">Settings at a glance</h2>
<p>These settings are a subset of the total available via <code>postgresql.conf</code>, but these particular settings are worth paying attention to.</p>
<p>How to tune each of these parameters is beyond the scope of this document. There are plenty of guides online, my recommnedation being <a href="https://pgtune.leopard.in.ua/">PGTune</a>. It provides a simple, web-based tool to generate “optimal” settings depending on your hardware and application.</p>
<p>The default settings that ship with postgres are almost never optimal, they are far too conservative and make poor use of modern hardware. Here’s my configuration tuned for test/dev on my laptop.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb13"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>(show (pgex/db-settings db))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="clay-table">
<table class="table table-hover table-responsive"><thead><tr><th>name</th><th>setting</th><th>unit</th><th>short_desc</th></tr></thead><tbody><tr><td>checkpoint_completion_target</td><td>0.75</td><td></td><td>Time spent flushing dirty buffers during checkpoint, as fraction of checkpoint interval.</td></tr><tr><td>default_statistics_target</td><td>100</td><td></td><td>Sets the default statistics target.</td></tr><tr><td>effective_cache_size</td><td>524288</td><td>8kB</td><td>Sets the planner's assumption about the total size of the data caches.</td></tr><tr><td>effective_io_concurrency</td><td>1</td><td></td><td>Number of simultaneous requests that can be handled efficiently by the disk subsystem.</td></tr><tr><td>maintenance_work_mem</td><td>655360</td><td>kB</td><td>Sets the maximum memory to be used for maintenance operations.</td></tr><tr><td>max_connections</td><td>400</td><td></td><td>Sets the maximum number of concurrent connections.</td></tr><tr><td>max_wal_size</td><td>1024</td><td>MB</td><td>Sets the WAL size that triggers a checkpoint.</td></tr><tr><td>min_wal_size</td><td>80</td><td>MB</td><td>Sets the minimum size to shrink the WAL to.</td></tr><tr><td>random_page_cost</td><td>4</td><td></td><td>Sets the planner's estimate of the cost of a nonsequentially fetched disk page.</td></tr><tr><td>shared_buffers</td><td>263168</td><td>8kB</td><td>Sets the number of shared memory buffers used by the server.</td></tr><tr><td>wal_buffers</td><td>2048</td><td>8kB</td><td>Sets the number of disk-page buffers in shared memory for WAL.</td></tr><tr><td>work_mem</td><td>40960</td><td>kB</td><td>Sets the maximum memory to be used for query workspaces.</td></tr></tbody><script>new DataTable(document.currentScript.parentElement, {"paging":false,"scrollY":false,"sPaginationType":"full_numbers","order":[],"scrollX":false,"pageLength":12});</script></table>
</div>
</div>
<p>example row</p>
<div class="printedClojure">
<div class="sourceCode" id="cb14"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:name</span> <span class="st">"checkpoint_completion_target"</span>,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:setting</span> <span class="st">"0.75"</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:unit</span> <span class="va">nil</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:short</span>_desc</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a> <span class="st">"Time spent flushing dirty buffers during checkpoint, as fraction of checkpoint interval."</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="full-map-of-database-objects-the-data-dictionary" class="level2">
<h2 class="anchored" data-anchor-id="full-map-of-database-objects-the-data-dictionary">Full map of database objects, the “data dictionary”</h2>
<div class="sourceClojure">
<div class="sourceCode" id="cb15"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> dd </span>(pgex/read-data-dictionary db))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb16"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">keys</span> dd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb17"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">:partition-children</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:columns</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:functions</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:tables</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:databases</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:schemas</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:partition-parents</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:indexes</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:views</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Or one object, one item at time</p>
<section id="list-all-databases" class="level3">
<h3 class="anchored" data-anchor-id="list-all-databases">List all databases</h3>
<div class="sourceClojure">
<div class="sourceCode" id="cb18"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>(show (pgex/databases db))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="clay-table">
<table class="table table-hover table-responsive"><thead><tr><th>oid</th><th>db_name</th><th>db_size</th><th>table_count</th><th>size_in_tables</th><th>extension_count</th></tr></thead><tbody><tr><td>19699</td><td>main</td><td>161 MB</td><td>72</td><td>162 MB</td><td>2</td></tr></tbody><script>new DataTable(document.currentScript.parentElement, {"paging":false,"scrollY":false,"sPaginationType":"full_numbers","order":[],"scrollX":false,"pageLength":12});</script></table>
</div>
</div>
<p>example row</p>
<div class="printedClojure">
<div class="sourceCode" id="cb19"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:oid</span> <span class="dv">19699</span>,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:db</span>_name <span class="st">"main"</span>,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:db</span>_size <span class="st">"161 MB"</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:table</span>_count <span class="dv">72</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:size</span>_in_tables <span class="st">"162 MB"</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:extension</span>_count <span class="dv">2</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="list-all-shemas-in-current-database" class="level3">
<h3 class="anchored" data-anchor-id="list-all-shemas-in-current-database">List all shemas in current database</h3>
<div class="sourceClojure">
<div class="sourceCode" id="cb20"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>(show-public (pgex/schemas db))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="clay-table">
<table class="table table-hover table-responsive"><thead><tr><th>size_pretty</th><th>description</th><th>view_count</th><th>size_plus_indexes</th><th>table_count</th><th>function_count</th><th>size_plus_indexes_bytes</th><th>s_name</th><th>system_object</th><th>owner</th><th>size_bytes</th></tr></thead><tbody><tr><td>132 MB</td><td>standard public schema</td><td>2</td><td>154 MB</td><td>4</td><td>3</td><td>161226752</td><td>public</td><td>false</td><td>pg_database_owner</td><td>138706944</td></tr></tbody><script>new DataTable(document.currentScript.parentElement, {"paging":false,"scrollY":false,"sPaginationType":"full_numbers","order":[],"scrollX":true,"pageLength":12});</script></table>
</div>
</div>
<p>example row</p>
<div class="printedClojure">
<div class="sourceCode" id="cb21"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:size</span>_pretty <span class="st">"248 kB"</span>,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:description</span> <span class="va">nil</span>,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:view</span>_count <span class="dv">65</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:size</span>_plus_indexes <span class="st">"248 kB"</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:table</span>_count <span class="dv">4</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:function</span>_count <span class="dv">11</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:size</span>_plus_indexes_bytes <span class="dv">253952</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:s</span>_name <span class="st">"information_schema"</span>,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:system</span>_object <span class="va">true</span>,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:owner</span> <span class="st">"postgres"</span>,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:size</span>_bytes <span class="dv">253952</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="list-all-view-objects-in-current-database" class="level3">
<h3 class="anchored" data-anchor-id="list-all-view-objects-in-current-database">List all view objects in current database</h3>
<div class="sourceClojure">
<div class="sourceCode" id="cb22"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>(show-public (pgex/views db))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="clay-table">
<table class="table table-hover table-responsive"><thead><tr><th>size_pretty</th><th>description</th><th>owned_by</th><th>size_plus_indexes</th><th>rows</th><th>oid</th><th>v_name</th><th>size_plus_indexes_bytes</th><th>s_name</th><th>system_object</th><th>view_type</th><th>size_bytes</th></tr></thead><tbody><tr><td>0 bytes</td><td></td><td>postgres</td><td>0 bytes</td><td>-1</td><td>19715</td><td>pg_stat_statements_info</td><td>0</td><td>public</td><td>false</td><td>view</td><td>0</td></tr><tr><td>0 bytes</td><td></td><td>postgres</td><td>0 bytes</td><td>-1</td><td>19726</td><td>pg_stat_statements</td><td>0</td><td>public</td><td>false</td><td>view</td><td>0</td></tr></tbody><script>new DataTable(document.currentScript.parentElement, {"paging":false,"scrollY":false,"sPaginationType":"full_numbers","order":[],"scrollX":true,"pageLength":12});</script></table>
</div>
</div>
<p>example row</p>
<div class="printedClojure">
<div class="sourceCode" id="cb23"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:size</span>_pretty <span class="st">"0 bytes"</span>,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:description</span> <span class="va">nil</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:owned</span>_by <span class="st">"postgres"</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:size</span>_plus_indexes <span class="st">"0 bytes"</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:rows</span> -<span class="dv">1</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:oid</span> <span class="dv">19715</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:v</span>_name <span class="st">"pg_stat_statements_info"</span>,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:size</span>_plus_indexes_bytes <span class="dv">0</span>,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:s</span>_name <span class="st">"public"</span>,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:system</span>_object <span class="va">false</span>,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:view</span>_type <span class="st">"view"</span>,</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a> <span class="at">:size</span>_bytes <span class="dv">0</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="list-all-index-objects-in-current-database" class="level3">
<h3 class="anchored" data-anchor-id="list-all-index-objects-in-current-database">List all index objects in current database</h3>
<div class="sourceClojure">
<div class="sourceCode" id="cb24"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>(show-public (pgex/indexes db))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="clay-table">
<table class="table table-hover table-responsive"><thead><tr><th>total_columns</th><th>unique_index</th><th>rows_indexed</th><th>oid</th><th>index_size_bytes</th><th>i_name</th><th>partial_index</th><th>index_size</th><th>key_columns</th><th>valid_index</th><th>s_name</th><th>system_object</th><th>primary_key</th><th>t_name</th></tr></thead><tbody><tr><td>1</td><td>true</td><td>10.0</td><td>19782</td><td>16384</td><td>pgbench_branches_pkey</td><td>false</td><td>16 kB</td><td>1</td><td>true</td><td>public</td><td>false</td><td>true</td><td>pgbench_branches</td></tr><tr><td>1</td><td>true</td><td>100.0</td><td>19784</td><td>16384</td><td>pgbench_tellers_pkey</td><td>false</td><td>16 kB</td><td>1</td><td>true</td><td>public</td><td>false</td><td>true</td><td>pgbench_tellers</td></tr><tr><td>1</td><td>true</td><td>1000000.0</td><td>19786</td><td>22487040</td><td>pgbench_accounts_pkey</td><td>false</td><td>21 MB</td><td>1</td><td>true</td><td>public</td><td>false</td><td>true</td><td>pgbench_accounts</td></tr></tbody><script>new DataTable(document.currentScript.parentElement, {"paging":false,"scrollY":false,"sPaginationType":"full_numbers","order":[],"scrollX":true,"pageLength":12});</script></table>
</div>
</div>
<p>example row</p>
<div class="printedClojure">
<div class="sourceCode" id="cb25"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:total</span>_columns <span class="dv">3</span>,</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:unique</span>_index <span class="va">true</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:rows</span>_indexed <span class="fl">0.0</span>,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:oid</span> <span class="dv">2696</span>,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:index</span>_size_bytes <span class="dv">32768</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:i</span>_name <span class="st">"pg_statistic_relid_att_inh_index"</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:partial</span>_index <span class="va">false</span>,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:index</span>_size <span class="st">"32 kB"</span>,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:key</span>_columns <span class="dv">3</span>,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:valid</span>_index <span class="va">true</span>,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:s</span>_name <span class="st">"pg_catalog"</span>,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a> <span class="at">:system</span>_object <span class="va">true</span>,</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a> <span class="at">:primary</span>_key <span class="va">true</span>,</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a> <span class="at">:t</span>_name <span class="st">"pg_statistic"</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="list-all-database-column-objects" class="level3">
<h3 class="anchored" data-anchor-id="list-all-database-column-objects">List all database column objects</h3>
<div class="sourceClojure">
<div class="sourceCode" id="cb26"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>(show-public (pgex/columns db))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="clay-table">
<table class="table table-hover table-responsive"><thead><tr><th>description</th><th>generated_column</th><th>source_type</th><th>data_type</th><th>c_name</th><th>position</th><th>s_name</th><th>system_object</th><th>default_value</th><th>t_name</th></tr></thead><tbody><tr><td></td><td>false</td><td>view</td><td>int8</td><td>dealloc</td><td>1</td><td>public</td><td>false</td><td></td><td>pg_stat_statements_info</td></tr><tr><td></td><td>false</td><td>view</td><td>timestamptz</td><td>stats_reset</td><td>2</td><td>public</td><td>false</td><td></td><td>pg_stat_statements_info</td></tr><tr><td></td><td>false</td><td>view</td><td>oid</td><td>userid</td><td>1</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>oid</td><td>dbid</td><td>2</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>bool</td><td>toplevel</td><td>3</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>int8</td><td>queryid</td><td>4</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>text</td><td>query</td><td>5</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>int8</td><td>plans</td><td>6</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>float8</td><td>total_plan_time</td><td>7</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>float8</td><td>min_plan_time</td><td>8</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>float8</td><td>max_plan_time</td><td>9</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>float8</td><td>mean_plan_time</td><td>10</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>float8</td><td>stddev_plan_time</td><td>11</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>int8</td><td>calls</td><td>12</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>float8</td><td>total_exec_time</td><td>13</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>float8</td><td>min_exec_time</td><td>14</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>float8</td><td>max_exec_time</td><td>15</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>float8</td><td>mean_exec_time</td><td>16</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>float8</td><td>stddev_exec_time</td><td>17</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>int8</td><td>rows</td><td>18</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>int8</td><td>shared_blks_hit</td><td>19</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>int8</td><td>shared_blks_read</td><td>20</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>int8</td><td>shared_blks_dirtied</td><td>21</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>int8</td><td>shared_blks_written</td><td>22</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>int8</td><td>local_blks_hit</td><td>23</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>int8</td><td>local_blks_read</td><td>24</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>int8</td><td>local_blks_dirtied</td><td>25</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>int8</td><td>local_blks_written</td><td>26</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>int8</td><td>temp_blks_read</td><td>27</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>int8</td><td>temp_blks_written</td><td>28</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>float8</td><td>blk_read_time</td><td>29</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>float8</td><td>blk_write_time</td><td>30</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>float8</td><td>temp_blk_read_time</td><td>31</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>float8</td><td>temp_blk_write_time</td><td>32</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>int8</td><td>wal_records</td><td>33</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>int8</td><td>wal_fpi</td><td>34</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>numeric</td><td>wal_bytes</td><td>35</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>int8</td><td>jit_functions</td><td>36</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>float8</td><td>jit_generation_time</td><td>37</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>int8</td><td>jit_inlining_count</td><td>38</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>float8</td><td>jit_inlining_time</td><td>39</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>int8</td><td>jit_optimization_count</td><td>40</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>float8</td><td>jit_optimization_time</td><td>41</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>int8</td><td>jit_emission_count</td><td>42</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>view</td><td>float8</td><td>jit_emission_time</td><td>43</td><td>public</td><td>false</td><td></td><td>pg_stat_statements</td></tr><tr><td></td><td>false</td><td>table</td><td>int4</td><td>tid</td><td>1</td><td>public</td><td>false</td><td></td><td>pgbench_history</td></tr><tr><td></td><td>false</td><td>table</td><td>int4</td><td>bid</td><td>2</td><td>public</td><td>false</td><td></td><td>pgbench_history</td></tr><tr><td></td><td>false</td><td>table</td><td>int4</td><td>aid</td><td>3</td><td>public</td><td>false</td><td></td><td>pgbench_history</td></tr><tr><td></td><td>false</td><td>table</td><td>int4</td><td>delta</td><td>4</td><td>public</td><td>false</td><td></td><td>pgbench_history</td></tr><tr><td></td><td>false</td><td>table</td><td>timestamp</td><td>mtime</td><td>5</td><td>public</td><td>false</td><td></td><td>pgbench_history</td></tr><tr><td></td><td>false</td><td>table</td><td>bpchar</td><td>filler</td><td>6</td><td>public</td><td>false</td><td></td><td>pgbench_history</td></tr><tr><td></td><td>false</td><td>table</td><td>int4</td><td>tid</td><td>1</td><td>public</td><td>false</td><td></td><td>pgbench_tellers</td></tr><tr><td></td><td>false</td><td>table</td><td>int4</td><td>bid</td><td>2</td><td>public</td><td>false</td><td></td><td>pgbench_tellers</td></tr><tr><td></td><td>false</td><td>table</td><td>int4</td><td>tbalance</td><td>3</td><td>public</td><td>false</td><td></td><td>pgbench_tellers</td></tr><tr><td></td><td>false</td><td>table</td><td>bpchar</td><td>filler</td><td>4</td><td>public</td><td>false</td><td></td><td>pgbench_tellers</td></tr><tr><td></td><td>false</td><td>table</td><td>int4</td><td>aid</td><td>1</td><td>public</td><td>false</td><td></td><td>pgbench_accounts</td></tr><tr><td></td><td>false</td><td>table</td><td>int4</td><td>bid</td><td>2</td><td>public</td><td>false</td><td></td><td>pgbench_accounts</td></tr><tr><td></td><td>false</td><td>table</td><td>int4</td><td>abalance</td><td>3</td><td>public</td><td>false</td><td></td><td>pgbench_accounts</td></tr><tr><td></td><td>false</td><td>table</td><td>bpchar</td><td>filler</td><td>4</td><td>public</td><td>false</td><td></td><td>pgbench_accounts</td></tr><tr><td></td><td>false</td><td>table</td><td>int4</td><td>bid</td><td>1</td><td>public</td><td>false</td><td></td><td>pgbench_branches</td></tr><tr><td></td><td>false</td><td>table</td><td>int4</td><td>bbalance</td><td>2</td><td>public</td><td>false</td><td></td><td>pgbench_branches</td></tr><tr><td></td><td>false</td><td>table</td><td>bpchar</td><td>filler</td><td>3</td><td>public</td><td>false</td><td></td><td>pgbench_branches</td></tr></tbody><script>new DataTable(document.currentScript.parentElement, {"paging":true,"scrollY":false,"sPaginationType":"full_numbers","order":[],"scrollX":true,"pageLength":12});</script></table>
</div>
</div>
<p>example row</p>
<div class="printedClojure">
<div class="sourceCode" id="cb27"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:description</span> <span class="va">nil</span>,</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:generated</span>_column <span class="va">false</span>,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:source</span>_type <span class="st">"table"</span>,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:data</span>_type <span class="st">"oid"</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:c</span>_name <span class="st">"oid"</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:position</span> <span class="dv">1</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:s</span>_name <span class="st">"pg_catalog"</span>,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:system</span>_object <span class="va">true</span>,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:default</span>_value <span class="va">nil</span>,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:t</span>_name <span class="st">"pg_proc"</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="list-all-table-objects-in-current-database" class="level3">
<h3 class="anchored" data-anchor-id="list-all-table-objects-in-current-database">List all table objects in current database</h3>
<div class="sourceClojure">
<div class="sourceCode" id="cb28"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>(show-public (pgex/tables db))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="clay-table">
<table class="table table-hover table-responsive"><thead><tr><th>size_pretty</th><th>description</th><th>owned_by</th><th>size_plus_indexes</th><th>rows</th><th>oid</th><th>data_type</th><th>size_plus_indexes_bytes</th><th>s_name</th><th>system_object</th><th>t_name</th><th>size_bytes</th><th>bytes_per_row</th></tr></thead><tbody><tr><td>144 kB</td><td></td><td>postgres</td><td>160 kB</td><td>10</td><td>19775</td><td>table</td><td>163840</td><td>public</td><td>false</td><td>pgbench_branches</td><td>147456</td><td>14746</td></tr><tr><td>256 kB</td><td></td><td>postgres</td><td>272 kB</td><td>100</td><td>19769</td><td>table</td><td>278528</td><td>public</td><td>false</td><td>pgbench_tellers</td><td>262144</td><td>2621</td></tr><tr><td>130 MB</td><td></td><td>postgres</td><td>152 MB</td><td>1000000</td><td>19772</td><td>table</td><td>158941184</td><td>public</td><td>false</td><td>pgbench_accounts</td><td>136454144</td><td>136</td></tr><tr><td>1800 kB</td><td></td><td>postgres</td><td>1800 kB</td><td>32000</td><td>19766</td><td>table</td><td>1843200</td><td>public</td><td>false</td><td>pgbench_history</td><td>1843200</td><td>58</td></tr></tbody><script>new DataTable(document.currentScript.parentElement, {"paging":false,"scrollY":false,"sPaginationType":"full_numbers","order":[],"scrollX":true,"pageLength":12});</script></table>
</div>
</div>
<p>example row</p>
<div class="printedClojure">
<div class="sourceCode" id="cb29"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:size</span>_pretty <span class="st">"280 kB"</span>,</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:description</span> <span class="va">nil</span>,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:owned</span>_by <span class="st">"postgres"</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:size</span>_plus_indexes <span class="st">"312 kB"</span>,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:rows</span> <span class="dv">409</span>,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:oid</span> <span class="dv">2619</span>,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:data</span>_type <span class="st">"table"</span>,</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:size</span>_plus_indexes_bytes <span class="dv">319488</span>,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:s</span>_name <span class="st">"pg_catalog"</span>,</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:system</span>_object <span class="va">true</span>,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:t</span>_name <span class="st">"pg_statistic"</span>,</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a> <span class="at">:size</span>_bytes <span class="dv">286720</span>,</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a> <span class="at">:bytes</span>_per_row <span class="dv">701</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="list-all-function-objects-in-current-database" class="level3">
<h3 class="anchored" data-anchor-id="list-all-function-objects-in-current-database">List all function objects in current database</h3>
<div class="sourceClojure">
<div class="sourceCode" id="cb30"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>(show-public (pgex/functions db))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="clay-table">
<table class="table table-hover table-responsive"><thead><tr><th>description</th><th>f_name</th><th>source_code</th><th>owned_by</th><th>proc_security</th><th>result_data_types</th><th>access_privileges</th><th>argument_data_types</th><th>s_name</th><th>proc_language</th><th>system_object</th></tr></thead><tbody><tr><td></td><td>pg_stat_statements_reset</td><td>pg_stat_statements_reset_1_7</td><td>postgres</td><td>invoker</td><td>void</td><td>postgres=X/postgres</td><td>userid oid DEFAULT 0, dbid oid DEFAULT 0, queryid bigint DEFAULT 0</td><td>public</td><td>c</td><td>false</td></tr><tr><td></td><td>pg_stat_statements_info</td><td>pg_stat_statements_info</td><td>postgres</td><td>invoker</td><td>record</td><td></td><td>OUT dealloc bigint, OUT stats_reset timestamp with time zone</td><td>public</td><td>c</td><td>false</td></tr><tr><td></td><td>pg_stat_statements</td><td>pg_stat_statements_1_10</td><td>postgres</td><td>invoker</td><td>SETOF record</td><td></td><td>showtext boolean, OUT userid oid, OUT dbid oid, OUT toplevel boolean, OUT queryid bigint, OUT query text, OUT plans bigint, OUT total_plan_time double precision, OUT min_plan_time double precision, OUT max_plan_time double precision, OUT mean_plan_time double precision, OUT stddev_plan_time double precision, OUT calls bigint, OUT total_exec_time double precision, OUT min_exec_time double precision, OUT max_exec_time double precision, OUT mean_exec_time double precision, OUT stddev_exec_time double precision, OUT rows bigint, OUT shared_blks_hit bigint, OUT shared_blks_read bigint, OUT shared_blks_dirtied bigint, OUT shared_blks_written bigint, OUT local_blks_hit bigint, OUT local_blks_read bigint, OUT local_blks_dirtied bigint, OUT local_blks_written bigint, OUT temp_blks_read bigint, OUT temp_blks_written bigint, OUT blk_read_time double precision, OUT blk_write_time double precision, OUT temp_blk_read_time double precision, OUT temp_blk_write_time double precision, OUT wal_records bigint, OUT wal_fpi bigint, OUT wal_bytes numeric, OUT jit_functions bigint, OUT jit_generation_time double precision, OUT jit_inlining_count bigint, OUT jit_inlining_time double precision, OUT jit_optimization_count bigint, OUT jit_optimization_time double precision, OUT jit_emission_count bigint, OUT jit_emission_time double precision</td><td>public</td><td>c</td><td>false</td></tr></tbody><script>new DataTable(document.currentScript.parentElement, {"paging":false,"scrollY":false,"sPaginationType":"full_numbers","order":[],"scrollX":true,"pageLength":12});</script></table>
</div>
</div>
<p>example row</p>
<div class="printedClojure">
<div class="sourceCode" id="cb31"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:description</span> <span class="st">"I/O"</span>,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:f</span>_name <span class="st">"boolin"</span>,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:source</span>_code <span class="st">"boolin"</span>,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:owned</span>_by <span class="st">"postgres"</span>,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:proc</span>_security <span class="st">"invoker"</span>,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:result</span>_data_types <span class="st">"boolean"</span>,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:access</span>_privileges <span class="va">nil</span>,</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:argument</span>_data_types <span class="st">"cstring"</span>,</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:s</span>_name <span class="st">"pg_catalog"</span>,</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:proc</span>_language <span class="st">"internal"</span>,</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:system</span>_object <span class="va">true</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="full-map-of-diagnostic-statistics" class="level2">
<h2 class="anchored" data-anchor-id="full-map-of-diagnostic-statistics">Full map of diagnostic statistics</h2>
<div class="sourceClojure">
<div class="sourceCode" id="cb32"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> stats </span>(pgex/read-stats db {<span class="at">:limit</span> <span class="dv">100</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb33"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">keys</span> stats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb34"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">:duplicate-indexes</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:db-settings</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:locks</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:vacuum-stats</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:index-usage</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:total-index-size</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:cache-hit</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:records-rank</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:null-indexes</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:index-cache-hit</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:all-locks</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a> <span class="at">:outliers</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a> <span class="at">:long-running-queries</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a> <span class="at">:extensions</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a> <span class="at">:total-table-size</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a> <span class="at">:unused-indexes</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a> <span class="at">:bloat</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a> <span class="at">:calls</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a> <span class="at">:table-size</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a> <span class="at">:connections</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a> <span class="at">:table-cache-hit</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a> <span class="at">:table-indexes-size</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a> <span class="at">:blocking</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a> <span class="at">:seq-scans</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a> <span class="at">:index-size</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="dead-rows-and-whether-an-automatic-vacuum-is-expected-to-be-triggered" class="level3">
<h3 class="anchored" data-anchor-id="dead-rows-and-whether-an-automatic-vacuum-is-expected-to-be-triggered">Dead rows and whether an automatic vacuum is expected to be triggered</h3>
<div class="sourceClojure">
<div class="sourceCode" id="cb35"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>(show (pgex/vacuum-stats db))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="clay-table">
<table class="table table-hover table-responsive"><thead><tr><th>schema</th><th>table</th><th>last_vacuum</th><th>last_autovacuum</th><th>rowcount</th><th>dead_rowcount</th><th>autovacuum_threshold</th><th>expect_autovacuum</th></tr></thead><tbody><tr><td>public</td><td>pgbench_branches</td><td>2024-07-11 09:08</td><td>2024-07-11 09:09</td><td>10.0</td><td>0</td><td>50.2</td><td></td></tr><tr><td>public</td><td>pgbench_tellers</td><td>2024-07-11 09:08</td><td>2024-07-11 09:09</td><td>100.0</td><td>0</td><td>52.0</td><td></td></tr><tr><td>public</td><td>pgbench_accounts</td><td>2024-07-11 09:08</td><td>2024-07-11 09:09</td><td>1000000.0</td><td>0</td><td>20050.0</td><td></td></tr><tr><td>public</td><td>pgbench_history</td><td>2024-07-11 09:08</td><td>2024-07-11 09:09</td><td>32000.0</td><td>0</td><td>690.0</td><td></td></tr></tbody><script>new DataTable(document.currentScript.parentElement, {"paging":false,"scrollY":false,"sPaginationType":"full_numbers","order":[],"scrollX":true,"pageLength":12});</script></table>
</div>
</div>
<p>example row</p>
<div class="printedClojure">
<div class="sourceCode" id="cb36"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:schema</span> <span class="st">"public"</span>,</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:table</span> <span class="st">"pgbench_branches"</span>,</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:last</span>_vacuum <span class="st">"2024-07-11 09:08"</span>,</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:last</span>_autovacuum <span class="st">"2024-07-11 09:09"</span>,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:rowcount</span> <span class="fl">10.0</span>,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:dead</span>_rowcount <span class="dv">0</span>,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:autovacuum</span>_threshold <span class="fl">50.2</span>,</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:expect</span>_autovacuum <span class="va">nil</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="index-hit-rate-effective-databases-are-at-99-and-up" class="level3">
<h3 class="anchored" data-anchor-id="index-hit-rate-effective-databases-are-at-99-and-up">Index hit rate (effective databases are at 99% and up)</h3>
<div class="sourceClojure">
<div class="sourceCode" id="cb37"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>(show (pgex/index-usage db))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="clay-table">
<table class="table table-hover table-responsive"><thead><tr><th>schema</th><th>name</th><th>percent_of_times_index_used</th><th>rows_in_table</th></tr></thead><tbody><tr><td>public</td><td>pgbench_accounts</td><td>99</td><td>1000000</td></tr><tr><td>public</td><td>pgbench_history</td><td></td><td>32000</td></tr><tr><td>public</td><td>pgbench_tellers</td><td>57</td><td>100</td></tr><tr><td>public</td><td>pgbench_branches</td><td>47</td><td>10</td></tr></tbody><script>new DataTable(document.currentScript.parentElement, {"paging":false,"scrollY":false,"sPaginationType":"full_numbers","order":[],"scrollX":false,"pageLength":12});</script></table>
</div>
</div>
<p>example row</p>
<div class="printedClojure">
<div class="sourceCode" id="cb38"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:schema</span> <span class="st">"public"</span>,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:name</span> <span class="st">"pgbench_accounts"</span>,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:percent</span>_of_times_index_used <span class="dv">99</span>,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:rows</span>_in_table <span class="dv">1000000</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="total-size-of-all-indexes-in-mb" class="level3">
<h3 class="anchored" data-anchor-id="total-size-of-all-indexes-in-mb">Total size of all indexes in MB</h3>
<div class="sourceClojure">
<div class="sourceCode" id="cb39"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>(pgex/total-index-size db)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb40"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>[{<span class="at">:size</span> <span class="dv">22519808</span>}]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>example row</p>
<div class="printedClojure">
<div class="sourceCode" id="cb41"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:size</span> <span class="dv">22519808</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="index-and-table-hit-rate" class="level3">
<h3 class="anchored" data-anchor-id="index-and-table-hit-rate">Index and table hit rate</h3>
<div class="sourceClojure">
<div class="sourceCode" id="cb42"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>(show (pgex/cache-hit db))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="clay-table">
<table class="table table-hover table-responsive"><thead><tr><th>name</th><th>ratio</th></tr></thead><tbody><tr><td>index hit rate</td><td>0.99319155048877683195</td></tr><tr><td>table hit rate</td><td>0.98325516438754727960</td></tr></tbody><script>new DataTable(document.currentScript.parentElement, {"paging":false,"scrollY":false,"sPaginationType":"full_numbers","order":[],"scrollX":false,"pageLength":12});</script></table>
</div>
</div>
<p>example row</p>
<div class="printedClojure">
<div class="sourceCode" id="cb43"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:name</span> <span class="st">"index hit rate"</span>, <span class="at">:ratio</span> <span class="fl">0.99319155048877683195M</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="all-tables-and-the-number-of-rows-in-each-ordered-by-number-of-rows-descending" class="level3">
<h3 class="anchored" data-anchor-id="all-tables-and-the-number-of-rows-in-each-ordered-by-number-of-rows-descending">All tables and the number of rows in each ordered by number of rows descending</h3>
<div class="sourceClojure">
<div class="sourceCode" id="cb44"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>(show (pgex/records-rank db))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="clay-table">
<table class="table table-hover table-responsive"><thead><tr><th>schema</th><th>name</th><th>estimated_count</th></tr></thead><tbody><tr><td>public</td><td>pgbench_accounts</td><td>1000000</td></tr><tr><td>public</td><td>pgbench_history</td><td>32000</td></tr><tr><td>public</td><td>pgbench_tellers</td><td>100</td></tr><tr><td>public</td><td>pgbench_branches</td><td>10</td></tr></tbody><script>new DataTable(document.currentScript.parentElement, {"paging":false,"scrollY":false,"sPaginationType":"full_numbers","order":[],"scrollX":false,"pageLength":12});</script></table>
</div>
</div>
<p>example row</p>
<div class="printedClojure">
<div class="sourceCode" id="cb45"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:schema</span> <span class="st">"public"</span>, <span class="at">:name</span> <span class="st">"pgbench_accounts"</span>, <span class="at">:estimated</span>_count <span class="dv">1000000</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="calculates-your-cache-hit-rate-for-reading-indexes" class="level3">
<h3 class="anchored" data-anchor-id="calculates-your-cache-hit-rate-for-reading-indexes">Calculates your cache hit rate for reading indexes</h3>
<div class="sourceClojure">
<div class="sourceCode" id="cb46"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>(show (pgex/index-cache-hit db))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="clay-table">
<table class="table table-hover table-responsive"><thead><tr><th>schema</th><th>name</th><th>buffer_hits</th><th>block_reads</th><th>total_read</th><th>ratio</th></tr></thead><tbody><tr><td>public</td><td>pgbench_history</td><td>0</td><td>0</td><td>0</td><td>0.0</td></tr><tr><td>public</td><td>pgbench_tellers</td><td>37366</td><td>2</td><td>37368</td><td>0.9999464782701777</td></tr><tr><td>public</td><td>pgbench_branches</td><td>31113</td><td>2</td><td>31115</td><td>0.9999357223204243</td></tr><tr><td>public</td><td>pgbench_accounts</td><td>332535</td><td>2745</td><td>335280</td><td>0.9918128131710809</td></tr></tbody><script>new DataTable(document.currentScript.parentElement, {"paging":false,"scrollY":false,"sPaginationType":"full_numbers","order":[],"scrollX":false,"pageLength":12});</script></table>
</div>
</div>
<p>example row</p>
<div class="printedClojure">
<div class="sourceCode" id="cb47"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:schema</span> <span class="st">"public"</span>,</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:name</span> <span class="st">"pgbench_history"</span>,</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:buffer</span>_hits <span class="dv">0</span>,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:block</span>_reads <span class="dv">0</span>,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:total</span>_read <span class="dv">0</span>,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:ratio</span> <span class="fl">0.0</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="queries-that-have-longest-execution-time-in-aggregate." class="level3">
<h3 class="anchored" data-anchor-id="queries-that-have-longest-execution-time-in-aggregate.">Queries that have longest execution time in aggregate.</h3>
<div class="sourceClojure">
<div class="sourceCode" id="cb48"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>(show (pgex/outliers db {<span class="at">:limit</span> <span class="dv">10</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="clay-table">
<table class="table table-hover table-responsive"><thead><tr><th>query</th><th>exec_time_ms</th><th>prop_exec_time</th><th>calls</th><th>sync_io_time_ms</th></tr></thead><tbody><tr><td>UPDATE pgbench_branches SET bbalance = bbalance + $1 WHERE bid = $2</td><td>12927.214</td><td>0.6611315873116744</td><td>32000</td><td>0.000</td></tr><tr><td>UPDATE pgbench_tellers SET tbalance = tbalance + $1 WHERE tid = $2</td><td>56300.972</td><td>0.28002054315890357</td><td>32000</td><td>0.000</td></tr><tr><td>INSERT INTO pgbench_history (tid, bid, aid, delta, mtime) VALUES ($1, $2, $3, $4, CURRENT_TIMESTAMP)</td><td>4857.433</td><td>0.02415910197939299</td><td>32000</td><td>0.000</td></tr><tr><td>UPDATE pgbench_accounts SET abalance = abalance + $1 WHERE aid = $2</td><td>1595.393</td><td>0.007934905239326415</td><td>32000</td><td>0.000</td></tr><tr><td>copy pgbench_accounts from stdin with (freeze on)</td><td>861.353</td><td>0.004284058693936155</td><td>1</td><td>0.000</td></tr><tr><td>CREATE EXTENSION IF NOT EXISTS postgis_tiger_geocoder</td><td>801.851</td><td>0.003988113665878356</td><td>1</td><td>0.000</td></tr><tr><td>CREATE EXTENSION IF NOT EXISTS postgis_tiger_geocoder</td><td>754.769</td><td>0.003753944251501428</td><td>1</td><td>0.000</td></tr><tr><td>CREATE EXTENSION IF NOT EXISTS postgis</td><td>383.233</td><td>0.0019060634875748212</td><td>1</td><td>0.000</td></tr><tr><td>CREATE EXTENSION IF NOT EXISTS postgis</td><td>375.006</td><td>0.0018651426830227464</td><td>1</td><td>0.000</td></tr><tr><td>SELECT abalance FROM pgbench_accounts WHERE aid = $1</td><td>357.088</td><td>0.001776025713694208</td><td>32000</td><td>0.000</td></tr></tbody><script>new DataTable(document.currentScript.parentElement, {"paging":false,"scrollY":false,"sPaginationType":"full_numbers","order":[],"scrollX":false,"pageLength":12});</script></table>
</div>
</div>
<p>example row</p>
<div class="printedClojure">
<div class="sourceCode" id="cb49"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:query</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a> <span class="st">"UPDATE pgbench_branches SET bbalance = bbalance + $1 WHERE bid = $2"</span>,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:exec</span>_time_ms <span class="fl">12927.214M</span>,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:prop</span>_exec_time <span class="fl">0.6611957059437592</span>,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:calls</span> <span class="dv">32000</span>,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:sync</span>_io_time_ms <span class="fl">0.000M</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="available-and-installed-extensions" class="level3">
<h3 class="anchored" data-anchor-id="available-and-installed-extensions">Available and installed extensions</h3>
<div class="sourceClojure">
<div class="sourceCode" id="cb50"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>(show (pgex/extensions db))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="clay-table">
<table class="table table-hover table-responsive"><thead><tr><th>name</th><th>default_version</th><th>installed_version</th><th>comment</th></tr></thead><tbody><tr><td>plpgsql</td><td>1.0</td><td>1.0</td><td>PL/pgSQL procedural language</td></tr><tr><td>pg_stat_statements</td><td>1.10</td><td>1.10</td><td>track planning and execution statistics of all SQL statements executed</td></tr><tr><td>ltree</td><td>1.2</td><td></td><td>data type for hierarchical tree-like structures</td></tr><tr><td>autoinc</td><td>1.0</td><td></td><td>functions for autoincrementing fields</td></tr><tr><td>lo</td><td>1.1</td><td></td><td>Large Object maintenance</td></tr><tr><td>tcn</td><td>1.0</td><td></td><td>Triggered change notifications</td></tr><tr><td>pgrowlocks</td><td>1.2</td><td></td><td>show row-level locking information</td></tr><tr><td>hstore</td><td>1.8</td><td></td><td>data type for storing sets of (key, value) pairs</td></tr><tr><td>file_fdw</td><td>1.0</td><td></td><td>foreign-data wrapper for flat file access</td></tr><tr><td>tsm_system_time</td><td>1.0</td><td></td><td>TABLESAMPLE method which accepts time in milliseconds as a limit</td></tr><tr><td>citext</td><td>1.6</td><td></td><td>data type for case-insensitive character strings</td></tr><tr><td>pgstattuple</td><td>1.5</td><td></td><td>show tuple-level statistics</td></tr><tr><td>pg_surgery</td><td>1.0</td><td></td><td>extension to perform surgery on a damaged relation</td></tr><tr><td>tablefunc</td><td>1.0</td><td></td><td>functions that manipulate whole tables, including crosstab</td></tr><tr><td>bloom</td><td>1.0</td><td></td><td>bloom access method - signature file based index</td></tr><tr><td>dblink</td><td>1.2</td><td></td><td>connect to other PostgreSQL databases from within a database</td></tr><tr><td>sslinfo</td><td>1.2</td><td></td><td>information about SSL certificates</td></tr><tr><td>refint</td><td>1.0</td><td></td><td>functions for implementing referential integrity (obsolete)</td></tr><tr><td>pg_walinspect</td><td>1.1</td><td></td><td>functions to inspect contents of PostgreSQL Write-Ahead Log</td></tr><tr><td>amcheck</td><td>1.3</td><td></td><td>functions for verifying relation integrity</td></tr><tr><td>adminpack</td><td>2.1</td><td></td><td>administrative functions for PostgreSQL</td></tr><tr><td>earthdistance</td><td>1.1</td><td></td><td>calculate great-circle distances on the surface of the Earth</td></tr><tr><td>pg_trgm</td><td>1.6</td><td></td><td>text similarity measurement and index searching based on trigrams</td></tr><tr><td>uuid-ossp</td><td>1.1</td><td></td><td>generate universally unique identifiers (UUIDs)</td></tr><tr><td>unaccent</td><td>1.1</td><td></td><td>text search dictionary that removes accents</td></tr><tr><td>seg</td><td>1.4</td><td></td><td>data type for representing line segments or floating-point intervals</td></tr><tr><td>moddatetime</td><td>1.0</td><td></td><td>functions for tracking last modification time</td></tr><tr><td>intagg</td><td>1.1</td><td></td><td>integer aggregator and enumerator (obsolete)</td></tr><tr><td>dict_xsyn</td><td>1.0</td><td></td><td>text search dictionary template for extended synonym processing</td></tr><tr><td>postgres_fdw</td><td>1.1</td><td></td><td>foreign-data wrapper for remote PostgreSQL servers</td></tr><tr><td>pg_visibility</td><td>1.2</td><td></td><td>examine the visibility map (VM) and page-level visibility info</td></tr><tr><td>btree_gist</td><td>1.7</td><td></td><td>support for indexing common datatypes in GiST</td></tr><tr><td>old_snapshot</td><td>1.0</td><td></td><td>utilities in support of old_snapshot_threshold</td></tr><tr><td>pg_prewarm</td><td>1.2</td><td></td><td>prewarm relation data</td></tr><tr><td>cube</td><td>1.5</td><td></td><td>data type for multidimensional cubes</td></tr><tr><td>isn</td><td>1.2</td><td></td><td>data types for international product numbering standards</td></tr><tr><td>xml2</td><td>1.1</td><td></td><td>XPath querying and XSLT</td></tr><tr><td>pg_freespacemap</td><td>1.2</td><td></td><td>examine the free space map (FSM)</td></tr><tr><td>intarray</td><td>1.5</td><td></td><td>functions, operators, and index support for 1-D arrays of integers</td></tr><tr><td>dict_int</td><td>1.0</td><td></td><td>text search dictionary template for integers</td></tr><tr><td>tsm_system_rows</td><td>1.0</td><td></td><td>TABLESAMPLE method which accepts number of rows as a limit</td></tr><tr><td>fuzzystrmatch</td><td>1.2</td><td></td><td>determine similarities and distance between strings</td></tr><tr><td>btree_gin</td><td>1.3</td><td></td><td>support for indexing common datatypes in GIN</td></tr><tr><td>pgcrypto</td><td>1.3</td><td></td><td>cryptographic functions</td></tr><tr><td>pageinspect</td><td>1.12</td><td></td><td>inspect the contents of database pages at a low level</td></tr><tr><td>postgis_topology-3</td><td>3.4.2</td><td></td><td>PostGIS topology spatial types and functions</td></tr><tr><td>postgis_raster</td><td>3.4.2</td><td></td><td>PostGIS raster types and functions</td></tr><tr><td>address_standardizer</td><td>3.4.2</td><td></td><td>Used to parse an address into constituent elements. Generally used to support geocoding address normalization step.</td></tr><tr><td>address_standardizer-3</td><td>3.4.2</td><td></td><td>Used to parse an address into constituent elements. Generally used to support geocoding address normalization step.</td></tr><tr><td>postgis_sfcgal</td><td>3.4.2</td><td></td><td>PostGIS SFCGAL functions</td></tr><tr><td>postgis</td><td>3.4.2</td><td></td><td>PostGIS geometry and geography spatial types and functions</td></tr><tr><td>postgis_tiger_geocoder</td><td>3.4.2</td><td></td><td>PostGIS tiger geocoder and reverse geocoder</td></tr><tr><td>postgis_raster-3</td><td>3.4.2</td><td></td><td>PostGIS raster types and functions</td></tr><tr><td>address_standardizer_data_us-3</td><td>3.4.2</td><td></td><td>Address Standardizer US dataset example</td></tr><tr><td>postgis_tiger_geocoder-3</td><td>3.4.2</td><td></td><td>PostGIS tiger geocoder and reverse geocoder</td></tr><tr><td>postgis_sfcgal-3</td><td>3.4.2</td><td></td><td>PostGIS SFCGAL functions</td></tr><tr><td>postgis-3</td><td>3.4.2</td><td></td><td>PostGIS geometry and geography spatial types and functions</td></tr><tr><td>postgis_topology</td><td>3.4.2</td><td></td><td>PostGIS topology spatial types and functions</td></tr><tr><td>pg_buffercache</td><td>1.4</td><td></td><td>examine the shared buffer cache</td></tr><tr><td>address_standardizer_data_us</td><td>3.4.2</td><td></td><td>Address Standardizer US dataset example</td></tr><tr><td>insert_username</td><td>1.0</td><td></td><td>functions for tracking who changed a table</td></tr></tbody><script>new DataTable(document.currentScript.parentElement, {"paging":true,"scrollY":false,"sPaginationType":"full_numbers","order":[],"scrollX":false,"pageLength":12});</script></table>
</div>
</div>
<p>example row</p>
<div class="printedClojure">
<div class="sourceCode" id="cb51"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:name</span> <span class="st">"plpgsql"</span>,</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:default</span>_version <span class="st">"1.0"</span>,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:installed</span>_version <span class="st">"1.0"</span>,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:comment</span> <span class="st">"PL/pgSQL procedural language"</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="size-of-the-tables-including-indexes-descending-by-size" class="level3">
<h3 class="anchored" data-anchor-id="size-of-the-tables-including-indexes-descending-by-size">Size of the tables (including indexes), descending by size</h3>
<div class="sourceClojure">
<div class="sourceCode" id="cb52"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>(show (pgex/total-table-size db))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="clay-table">
<table class="table table-hover table-responsive"><thead><tr><th>schema</th><th>name</th><th>size</th></tr></thead><tbody><tr><td>public</td><td>pgbench_accounts</td><td>158941184</td></tr><tr><td>public</td><td>pgbench_history</td><td>1843200</td></tr><tr><td>public</td><td>pgbench_tellers</td><td>278528</td></tr><tr><td>public</td><td>pgbench_branches</td><td>163840</td></tr></tbody><script>new DataTable(document.currentScript.parentElement, {"paging":false,"scrollY":false,"sPaginationType":"full_numbers","order":[],"scrollX":false,"pageLength":12});</script></table>
</div>
</div>
<p>example row</p>
<div class="printedClojure">
<div class="sourceCode" id="cb53"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:schema</span> <span class="st">"public"</span>, <span class="at">:name</span> <span class="st">"pgbench_accounts"</span>, <span class="at">:size</span> <span class="dv">158941184</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="table-and-index-bloat-in-your-database-ordered-by-most-wasteful" class="level3">
<h3 class="anchored" data-anchor-id="table-and-index-bloat-in-your-database-ordered-by-most-wasteful">Table and index bloat in your database ordered by most wasteful</h3>
<div class="sourceClojure">
<div class="sourceCode" id="cb54"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>(show (pgex/bloat db))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="clay-table">
<table class="table table-hover table-responsive"><thead><tr><th>type</th><th>schemaname</th><th>object_name</th><th>bloat</th><th>waste</th></tr></thead><tbody><tr><td>table</td><td>public</td><td>pgbench_accounts</td><td>1.1</td><td>8069120</td></tr><tr><td>table</td><td>public</td><td>pgbench_tellers</td><td>28.0</td><td>221184</td></tr><tr><td>table</td><td>public</td><td>pgbench_branches</td><td>14.0</td><td>106496</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_ts_config_map::pg_ts_config_map_index</td><td>2.0</td><td>16384</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_amproc::pg_amproc_fam_proc_index</td><td>1.7</td><td>16384</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_class</td><td>1.2</td><td>16384</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_range::pg_range_rngmultitypid_index</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_auth_members::pg_auth_members_grantor_index</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_auth_members::pg_auth_members_member_role_index</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_auth_members::pg_auth_members_oid_index</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_auth_members::pg_auth_members_role_member_index</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_authid::pg_authid_oid_index</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_authid::pg_authid_rolname_index</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_cast::pg_cast_oid_index</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_cast::pg_cast_source_target_index</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_namespace::pg_namespace_oid_index</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_ts_config::pg_ts_config_cfgname_index</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_tablespace::pg_tablespace_spcname_index</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_tablespace::pg_tablespace_oid_index</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_shdescription::pg_shdescription_o_c_index</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_range::pg_range_rngtypid_index</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_extension::pg_extension_oid_index</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_ts_dict::pg_ts_dict_dictname_index</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_language::pg_language_name_index</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_language::pg_language_oid_index</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_namespace::pg_namespace_nspname_index</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_ts_config::pg_ts_config_oid_index</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>public</td><td>pgbench_tellers::pgbench_tellers_pkey</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>public</td><td>pgbench_branches::pgbench_branches_pkey</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_ts_template::pg_ts_template_tmplname_index</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_ts_template::pg_ts_template_oid_index</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_ts_parser::pg_ts_parser_prsname_index</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_ts_parser::pg_ts_parser_oid_index</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_am::pg_am_oid_index</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_am::pg_am_name_index</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_database::pg_database_datname_index</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_database::pg_database_oid_index</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_ts_dict::pg_ts_dict_oid_index</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_extension::pg_extension_name_index</td><td>2.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_amproc::pg_amproc_oid_index</td><td>1.3</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_amop::pg_amop_fam_strat_index</td><td>1.2</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_amop::pg_amop_opr_fam_index</td><td>1.2</td><td>8192</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_depend</td><td>1.1</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_depend::pg_depend_depender_index</td><td>1.1</td><td>8192</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_description</td><td>1.0</td><td>8192</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_conversion::pg_conversion_default_index</td><td>1.0</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_amop::pg_amop_oid_index</td><td>1.0</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_aggregate::pg_aggregate_fnoid_index</td><td>1.0</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_conversion::pg_conversion_name_nsp_index</td><td>1.0</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_conversion::pg_conversion_oid_index</td><td>1.0</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_depend::pg_depend_reference_index</td><td>1.0</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_init_privs::pg_init_privs_o_c_o_index</td><td>1.0</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_opfamily::pg_opfamily_am_name_nsp_index</td><td>1.0</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_opfamily::pg_opfamily_oid_index</td><td>1.0</td><td>0</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_am</td><td>1.0</td><td>0</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_amop</td><td>1.0</td><td>0</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_amproc</td><td>1.0</td><td>0</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_attribute</td><td>1.0</td><td>0</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_auth_members</td><td>1.0</td><td>0</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_authid</td><td>1.0</td><td>0</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_cast</td><td>1.0</td><td>0</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_constraint</td><td>1.0</td><td>0</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_conversion</td><td>1.0</td><td>0</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_database</td><td>1.0</td><td>0</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_extension</td><td>1.0</td><td>0</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_index</td><td>1.0</td><td>0</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_init_privs</td><td>1.0</td><td>0</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_language</td><td>1.0</td><td>0</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_namespace</td><td>1.0</td><td>0</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_opclass</td><td>1.0</td><td>0</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_operator</td><td>1.0</td><td>0</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_opfamily</td><td>1.0</td><td>0</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_proc</td><td>1.0</td><td>0</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_range</td><td>1.0</td><td>0</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_rewrite</td><td>1.0</td><td>0</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_shdescription</td><td>1.0</td><td>0</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_tablespace</td><td>1.0</td><td>0</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_ts_config</td><td>1.0</td><td>0</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_ts_config_map</td><td>1.0</td><td>0</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_ts_dict</td><td>1.0</td><td>0</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_ts_parser</td><td>1.0</td><td>0</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_ts_template</td><td>1.0</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_description::pg_description_o_c_o_index</td><td>0.9</td><td>0</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_collation</td><td>0.9</td><td>0</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_type</td><td>0.9</td><td>0</td></tr><tr><td>table</td><td>public</td><td>pgbench_history</td><td>0.7</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_opclass::pg_opclass_oid_index</td><td>0.7</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_opclass::pg_opclass_am_name_nsp_index</td><td>0.7</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_index::pg_index_indrelid_index</td><td>0.7</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_index::pg_index_indexrelid_index</td><td>0.7</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_constraint::pg_constraint_oid_index</td><td>0.7</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_constraint::pg_constraint_contypid_index</td><td>0.7</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_constraint::pg_constraint_conrelid_contypid_conname_index</td><td>0.7</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_constraint::pg_constraint_conparentid_index</td><td>0.7</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_constraint::pg_constraint_conname_nsp_index</td><td>0.7</td><td>0</td></tr><tr><td>table</td><td>pg_catalog</td><td>pg_aggregate</td><td>0.7</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_class::pg_class_relname_nsp_index</td><td>0.6</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_collation::pg_collation_name_enc_nsp_index</td><td>0.5</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_operator::pg_operator_oprname_l_r_n_index</td><td>0.5</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_collation::pg_collation_oid_index</td><td>0.5</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_proc::pg_proc_proname_args_nsp_index</td><td>0.4</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_type::pg_type_typname_nsp_index</td><td>0.4</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_operator::pg_operator_oid_index</td><td>0.4</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_attribute::pg_attribute_relid_attnam_index</td><td>0.4</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_class::pg_class_oid_index</td><td>0.4</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_type::pg_type_oid_index</td><td>0.3</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_attribute::pg_attribute_relid_attnum_index</td><td>0.2</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_rewrite::pg_rewrite_oid_index</td><td>0.2</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_rewrite::pg_rewrite_rel_rulename_index</td><td>0.2</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_class::pg_class_tblspc_relfilenode_index</td><td>0.2</td><td>0</td></tr><tr><td>index</td><td>public</td><td>pgbench_accounts::pgbench_accounts_pkey</td><td>0.2</td><td>0</td></tr><tr><td>index</td><td>pg_catalog</td><td>pg_proc::pg_proc_oid_index</td><td>0.1</td><td>0</td></tr></tbody><script>new DataTable(document.currentScript.parentElement, {"paging":true,"scrollY":false,"sPaginationType":"full_numbers","order":[],"scrollX":false,"pageLength":12});</script></table>
</div>
</div>
<p>example row</p>
<div class="printedClojure">
<div class="sourceCode" id="cb55"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:type</span> <span class="st">"table"</span>,</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:schemaname</span> <span class="st">"public"</span>,</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:object</span>_name <span class="st">"pgbench_accounts"</span>,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:bloat</span> <span class="fl">1.1M</span>,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:waste</span> <span class="dv">8069120</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="queries-that-have-the-highest-frequency-of-execution" class="level3">
<h3 class="anchored" data-anchor-id="queries-that-have-the-highest-frequency-of-execution">Queries that have the highest frequency of execution</h3>
<div class="sourceClojure">
<div class="sourceCode" id="cb56"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>(show (pgex/calls db {<span class="at">:limit</span> <span class="dv">10</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="clay-table">
<table class="table table-hover table-responsive"><thead><tr><th>query</th><th>exec_time_ms</th><th>exec_time_ratio</th><th>calls</th><th>sync_io_time_ms</th></tr></thead><tbody><tr><td>begin</td><td>18.790</td><td>9.344053884633071E-5</td><td>32001</td><td>0.000</td></tr><tr><td>commit</td><td>16.909</td><td>8.408883014320269E-5</td><td>32001</td><td>0.000</td></tr><tr><td>UPDATE pgbench_tellers SET tbalance = tbalance + $1 WHERE tid = $2</td><td>56300.972</td><td>0.2799803284828244</td><td>32000</td><td>0.000</td></tr><tr><td>UPDATE pgbench_branches SET bbalance = bbalance + $1 WHERE bid = $2</td><td>12927.214</td><td>0.6610366400184169</td><td>32000</td><td>0.000</td></tr><tr><td>UPDATE pgbench_accounts SET abalance = abalance + $1 WHERE aid = $2</td><td>1595.393</td><td>0.007933765681348567</td><td>32000</td><td>0.000</td></tr><tr><td>INSERT INTO pgbench_history (tid, bid, aid, delta, mtime) VALUES ($1, $2, $3, $4, CURRENT_TIMESTAMP)</td><td>4857.433</td><td>0.024155632410876676</td><td>32000</td><td>0.000</td></tr><tr><td>SELECT abalance FROM pgbench_accounts WHERE aid = $1</td><td>357.088</td><td>0.0017757706527691105</td><td>32000</td><td>0.000</td></tr><tr><td>SET extra_float_digits = 3</td><td>2.040</td><td>1.0145014050072743E-5</td><td>193</td><td>0.000</td></tr><tr><td>SET application_name = 'PostgreSQL JDBC Driver'</td><td>1.073</td><td>5.336477172497848E-6</td><td>193</td><td>0.000</td></tr><tr><td>insert into pgbench_tellers(tid,bid,tbalance) values ($1,$2,$3)</td><td>0.384</td><td>1.909149427612044E-6</td><td>100</td><td>0.000</td></tr></tbody><script>new DataTable(document.currentScript.parentElement, {"paging":false,"scrollY":false,"sPaginationType":"full_numbers","order":[],"scrollX":false,"pageLength":12});</script></table>
</div>
</div>
<p>example row</p>
<div class="printedClojure">
<div class="sourceCode" id="cb57"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:query</span> <span class="st">"begin"</span>,</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:exec</span>_time_ms <span class="fl">18.790M</span>,</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:exec</span>_time_ratio <span class="fl">9.345651768536889E-5</span>,</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:calls</span> <span class="dv">32001</span>,</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:sync</span>_io_time_ms <span class="fl">0.000M</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="size-of-the-tables-excluding-indexes-descending-by-size" class="level3">
<h3 class="anchored" data-anchor-id="size-of-the-tables-excluding-indexes-descending-by-size">Size of the tables (excluding indexes), descending by size</h3>
<div class="sourceClojure">
<div class="sourceCode" id="cb58"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>(show (pgex/table-size db))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="clay-table">
<table class="table table-hover table-responsive"><thead><tr><th>schema</th><th>name</th><th>size</th></tr></thead><tbody><tr><td>public</td><td>pgbench_accounts</td><td>136454144</td></tr><tr><td>public</td><td>pgbench_history</td><td>1843200</td></tr><tr><td>public</td><td>pgbench_tellers</td><td>262144</td></tr><tr><td>public</td><td>pgbench_branches</td><td>147456</td></tr></tbody><script>new DataTable(document.currentScript.parentElement, {"paging":false,"scrollY":false,"sPaginationType":"full_numbers","order":[],"scrollX":false,"pageLength":12});</script></table>
</div>
</div>
<p>example row</p>
<div class="printedClojure">
<div class="sourceCode" id="cb59"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:schema</span> <span class="st">"public"</span>, <span class="at">:name</span> <span class="st">"pgbench_accounts"</span>, <span class="at">:size</span> <span class="dv">136454144</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="returns-the-list-of-all-active-database-connections" class="level3">
<h3 class="anchored" data-anchor-id="returns-the-list-of-all-active-database-connections">Returns the list of all active database connections</h3>
<div class="sourceClojure">
<div class="sourceCode" id="cb60"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>(show (pgex/connections db))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="clay-table">
<table class="table table-hover table-responsive"><thead><tr><th>username</th><th>client_address</th><th>application_name</th></tr></thead><tbody><tr><td>postgres</td><td>172.20.0.1/32</td><td>psql</td></tr><tr><td>postgres</td><td>172.20.0.1/32</td><td>PostgreSQL JDBC Driver</td></tr></tbody><script>new DataTable(document.currentScript.parentElement, {"paging":false,"scrollY":false,"sPaginationType":"full_numbers","order":[],"scrollX":false,"pageLength":12});</script></table>
</div>
</div>
<p>example row</p>
<div class="printedClojure">
<div class="sourceCode" id="cb61"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:username</span> <span class="st">"postgres"</span>,</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:client</span>_address <span class="st">"172.20.0.1/32"</span>,</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:application</span>_name <span class="st">"psql"</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="calculates-your-cache-hit-rate-for-reading-tables" class="level3">
<h3 class="anchored" data-anchor-id="calculates-your-cache-hit-rate-for-reading-tables">Calculates your cache hit rate for reading tables</h3>
<div class="sourceClojure">
<div class="sourceCode" id="cb62"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>(show (pgex/table-cache-hit db))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="clay-table">
<table class="table table-hover table-responsive"><thead><tr><th>schema</th><th>name</th><th>buffer_hits</th><th>block_reads</th><th>total_read</th><th>ratio</th></tr></thead><tbody><tr><td>public</td><td>pgbench_branches</td><td>671318</td><td>0</td><td>671318</td><td>1.0</td></tr><tr><td>public</td><td>pgbench_tellers</td><td>488771</td><td>0</td><td>488771</td><td>1.0</td></tr><tr><td>public</td><td>pgbench_history</td><td>129424</td><td>0</td><td>129424</td><td>1.0</td></tr><tr><td>public</td><td>pgbench_accounts</td><td>400211</td><td>28776</td><td>428987</td><td>0.9329210442274475</td></tr></tbody><script>new DataTable(document.currentScript.parentElement, {"paging":false,"scrollY":false,"sPaginationType":"full_numbers","order":[],"scrollX":false,"pageLength":12});</script></table>
</div>
</div>
<p>example row</p>
<div class="printedClojure">
<div class="sourceCode" id="cb63"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:schema</span> <span class="st">"public"</span>,</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:name</span> <span class="st">"pgbench_branches"</span>,</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:buffer</span>_hits <span class="dv">671318</span>,</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:block</span>_reads <span class="dv">0</span>,</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:total</span>_read <span class="dv">671318</span>,</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:ratio</span> <span class="fl">1.0</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="total-size-of-all-the-indexes-on-each-table-descending-by-size" class="level3">
<h3 class="anchored" data-anchor-id="total-size-of-all-the-indexes-on-each-table-descending-by-size">Total size of all the indexes on each table, descending by size</h3>
<div class="sourceClojure">
<div class="sourceCode" id="cb64"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>(show (pgex/table-indexes-size db))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="clay-table">
<table class="table table-hover table-responsive"><thead><tr><th>schema</th><th>table</th><th>index_size</th></tr></thead><tbody><tr><td>public</td><td>pgbench_accounts</td><td>22487040</td></tr><tr><td>public</td><td>pgbench_branches</td><td>16384</td></tr><tr><td>public</td><td>pgbench_tellers</td><td>16384</td></tr><tr><td>public</td><td>pgbench_history</td><td>0</td></tr></tbody><script>new DataTable(document.currentScript.parentElement, {"paging":false,"scrollY":false,"sPaginationType":"full_numbers","order":[],"scrollX":false,"pageLength":12});</script></table>
</div>
</div>
<p>example row</p>
<div class="printedClojure">
<div class="sourceCode" id="cb65"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:schema</span> <span class="st">"public"</span>, <span class="at">:table</span> <span class="st">"pgbench_accounts"</span>, <span class="at">:index</span>_size <span class="dv">22487040</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="count-of-sequential-scans-by-table-descending-by-order" class="level3">
<h3 class="anchored" data-anchor-id="count-of-sequential-scans-by-table-descending-by-order">Count of sequential scans by table descending by order</h3>
<div class="sourceClojure">
<div class="sourceCode" id="cb66"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>(show (pgex/seq-scans db))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="clay-table">
<table class="table table-hover table-responsive"><thead><tr><th>schema</th><th>name</th><th>count</th></tr></thead><tbody><tr><td>public</td><td>pgbench_branches</td><td>33352</td></tr><tr><td>public</td><td>pgbench_tellers</td><td>27304</td></tr><tr><td>public</td><td>pgbench_accounts</td><td>4</td></tr><tr><td>public</td><td>pgbench_history</td><td>3</td></tr></tbody><script>new DataTable(document.currentScript.parentElement, {"paging":false,"scrollY":false,"sPaginationType":"full_numbers","order":[],"scrollX":false,"pageLength":12});</script></table>
</div>
</div>
<p>example row</p>
<div class="printedClojure">
<div class="sourceCode" id="cb67"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:schema</span> <span class="st">"public"</span>, <span class="at">:name</span> <span class="st">"pgbench_branches"</span>, <span class="at">:count</span> <span class="dv">33352</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-size-of-indexes-descending-by-size" class="level3">
<h3 class="anchored" data-anchor-id="the-size-of-indexes-descending-by-size">The size of indexes, descending by size</h3>
<div class="sourceClojure">
<div class="sourceCode" id="cb68"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>(show (pgex/index-size db))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="clay-table">
<table class="table table-hover table-responsive"><thead><tr><th>schema</th><th>name</th><th>size</th></tr></thead><tbody><tr><td>public</td><td>pgbench_accounts_pkey</td><td>22487040</td></tr><tr><td>public</td><td>pgbench_branches_pkey</td><td>16384</td></tr><tr><td>public</td><td>pgbench_tellers_pkey</td><td>16384</td></tr></tbody><script>new DataTable(document.currentScript.parentElement, {"paging":false,"scrollY":false,"sPaginationType":"full_numbers","order":[],"scrollX":false,"pageLength":12});</script></table>
</div>
</div>
<p>example row</p>
<div class="printedClojure">
<div class="sourceCode" id="cb69"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:schema</span> <span class="st">"public"</span>, <span class="at">:name</span> <span class="st">"pgbench_accounts_pkey"</span>, <span class="at">:size</span> <span class="dv">22487040</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="the-kill-switch" class="level2">
<h2 class="anchored" data-anchor-id="the-kill-switch">The Kill Switch</h2>
<p>The only mutating function in the entire library is a kill switch for closing all connections, vital if you need to take a heavily-used database down for maintenance or emergency.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>(pgex/kill-all! db)  <span class="co">;; use with caution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="diagnostics" class="level2">
<h2 class="anchored" data-anchor-id="diagnostics">Diagnostics</h2>
<p>Query and and print all default diagnostics</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb71"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">for</span> [d (pgex/diagnose (pgex/read-stats db))]</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  (<span class="at">:message</span> d))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb72"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>(<span class="st">"✓  Passed :bloat public.pgbench_accounts"</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a> <span class="st">"! Warning :bloat public.pgbench_tellers Bloated tables</span><span class="sc">\n</span><span class="st">{:type </span><span class="sc">\"</span><span class="st">table</span><span class="sc">\"</span><span class="st">, :schemaname </span><span class="sc">\"</span><span class="st">public</span><span class="sc">\"</span><span class="st">, :object_name </span><span class="sc">\"</span><span class="st">pgbench_tellers</span><span class="sc">\"</span><span class="st">, :bloat 28.0M, :waste 221184}"</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a> <span class="st">"! Warning :bloat public.pgbench_branches Bloated tables</span><span class="sc">\n</span><span class="st">{:type </span><span class="sc">\"</span><span class="st">table</span><span class="sc">\"</span><span class="st">, :schemaname </span><span class="sc">\"</span><span class="st">public</span><span class="sc">\"</span><span class="st">, :object_name </span><span class="sc">\"</span><span class="st">pgbench_branches</span><span class="sc">\"</span><span class="st">, :bloat 14.0M, :waste 106496}"</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a> <span class="st">"✓  Passed :bloat pg_catalog.pg_ts_config_map::pg_ts_config_map_index"</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a> <span class="st">"✓  Passed :bloat pg_catalog.pg_amproc::pg_amproc_fam_proc_index"</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a> <span class="st">"✓  Passed :bloat pg_catalog.pg_class"</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a> <span class="st">"✓  Passed :bloat pg_catalog.pg_range::pg_range_rngmultitypid_index"</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a> <span class="st">"✓  Passed :bloat pg_catalog.pg_auth_members::pg_auth_members_grantor_index"</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a> <span class="st">"✓  Passed :bloat pg_catalog.pg_auth_members::pg_auth_members_member_role_index"</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a> <span class="st">"✓  Passed :bloat pg_catalog.pg_auth_members::pg_auth_members_oid_index"</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a> <span class="st">"✓  Passed :index-cache-hit public.pgbench_history"</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a> <span class="st">"✓  Passed :index-cache-hit public.pgbench_tellers"</span></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a> <span class="st">"✓  Passed :index-cache-hit public.pgbench_branches"</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a> <span class="st">"✓  Passed :index-cache-hit public.pgbench_accounts"</span></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a> <span class="st">"! Warning :outliers UPDATE pgbench_branches SET bbalance = bbalance + $1 WHERE bid = $2 Detected slow query</span><span class="sc">\n</span><span class="st">{:query </span><span class="sc">\"</span><span class="st">UPDATE pgbench_branches SET bbalance = bbalance + $1 WHERE bid = $2</span><span class="sc">\"</span><span class="st">, :exec_time_ms 12927.214M, :prop_exec_time 0.6609846146270376, :calls 32000, :sync_io_time_ms 0.000M}"</span></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a> <span class="st">"✓  Passed :outliers UPDATE pgbench_tellers SET tbalance = tbalance + $1 WHERE tid = $2"</span></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a> <span class="st">"✓  Passed :outliers INSERT INTO pgbench_history (tid, bid, aid, delta, mtime) VALUES ($1, $2, $3, $4, CURRENT_TIMESTAMP)"</span></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a> <span class="st">"✓  Passed :outliers UPDATE pgbench_accounts SET abalance = abalance + $1 WHERE aid = $2"</span></span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a> <span class="st">"✓  Passed :outliers copy pgbench_accounts from stdin with (freeze on)"</span></span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a> <span class="st">"✓  Passed :outliers CREATE EXTENSION IF NOT EXISTS postgis_tiger_geocoder"</span></span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a> <span class="st">"✓  Passed :outliers CREATE EXTENSION IF NOT EXISTS postgis_tiger_geocoder"</span></span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a> <span class="st">"✓  Passed :outliers CREATE EXTENSION IF NOT EXISTS postgis"</span></span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a> <span class="st">"✓  Passed :outliers CREATE EXTENSION IF NOT EXISTS postgis"</span></span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a> <span class="st">"✓  Passed :outliers SELECT abalance FROM pgbench_accounts WHERE aid = $1"</span></span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a> <span class="st">"✓  Passed :table-cache-hit public.pgbench_branches"</span></span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a> <span class="st">"✓  Passed :table-cache-hit public.pgbench_tellers"</span></span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a> <span class="st">"✓  Passed :table-cache-hit public.pgbench_history"</span></span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a> <span class="st">"! Warning :table-cache-hit public.pgbench_accounts Table sees too much block IO relative to buffer cache hit</span><span class="sc">\n</span><span class="st">{:schema </span><span class="sc">\"</span><span class="st">public</span><span class="sc">\"</span><span class="st">, :name </span><span class="sc">\"</span><span class="st">pgbench_accounts</span><span class="sc">\"</span><span class="st">, :buffer_hits 400211, :block_reads 28776, :total_read 428987, :ratio 0.9329210442274475}"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Or just the warnings</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb73"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">for</span> [w (pgex/diagnose-warnings (pgex/read-stats db))]</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  (<span class="at">:message</span> w))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb74"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>(<span class="st">"! Warning :bloat public.pgbench_tellers Bloated tables</span><span class="sc">\n</span><span class="st">{:type </span><span class="sc">\"</span><span class="st">table</span><span class="sc">\"</span><span class="st">, :schemaname </span><span class="sc">\"</span><span class="st">public</span><span class="sc">\"</span><span class="st">, :object_name </span><span class="sc">\"</span><span class="st">pgbench_tellers</span><span class="sc">\"</span><span class="st">, :bloat 28.0M, :waste 221184}"</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a> <span class="st">"! Warning :bloat public.pgbench_branches Bloated tables</span><span class="sc">\n</span><span class="st">{:type </span><span class="sc">\"</span><span class="st">table</span><span class="sc">\"</span><span class="st">, :schemaname </span><span class="sc">\"</span><span class="st">public</span><span class="sc">\"</span><span class="st">, :object_name </span><span class="sc">\"</span><span class="st">pgbench_branches</span><span class="sc">\"</span><span class="st">, :bloat 14.0M, :waste 106496}"</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a> <span class="st">"! Warning :outliers UPDATE pgbench_branches SET bbalance = bbalance + $1 WHERE bid = $2 Detected slow query</span><span class="sc">\n</span><span class="st">{:query </span><span class="sc">\"</span><span class="st">UPDATE pgbench_branches SET bbalance = bbalance + $1 WHERE bid = $2</span><span class="sc">\"</span><span class="st">, :exec_time_ms 12927.214M, :prop_exec_time 0.6608529285154046, :calls 32000, :sync_io_time_ms 0.000M}"</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a> <span class="st">"! Warning :table-cache-hit public.pgbench_accounts Table sees too much block IO relative to buffer cache hit</span><span class="sc">\n</span><span class="st">{:schema </span><span class="sc">\"</span><span class="st">public</span><span class="sc">\"</span><span class="st">, :name </span><span class="sc">\"</span><span class="st">pgbench_accounts</span><span class="sc">\"</span><span class="st">, :buffer_hits 400211, :block_reads 28776, :total_read 428987, :ratio 0.9329210442274475}"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Create your own diagnostics</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb75"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> unrealistic-expectations</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  {<span class="at">:table-cache-hit</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>   {<span class="at">:pred</span> #(<span class="kw">&gt;</span> (<span class="at">:ratio</span> <span class="va">%</span>) <span class="fl">0.999</span>)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">:onfalse</span> <span class="st">"The cache hit ratio is not as insanely high as I'd like."</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">:idfn</span> <span class="at">:name</span>}})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb76"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">for</span> [w (pgex/diagnose-warnings</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>         (pgex/read-stats db)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">:diagnostic-fns</span> unrealistic-expectations)]</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  (<span class="at">:message</span> w))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb77"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>(<span class="st">"! Warning :table-cache-hit pgbench_accounts The cache hit ratio is not as insanely high as I'd like.</span><span class="sc">\n</span><span class="st">{:schema </span><span class="sc">\"</span><span class="st">public</span><span class="sc">\"</span><span class="st">, :name </span><span class="sc">\"</span><span class="st">pgbench_accounts</span><span class="sc">\"</span><span class="st">, :buffer_hits 400211, :block_reads 28776, :total_read 428987, :ratio 0.9329210442274475}"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="just-for-fun" class="level2">
<h2 class="anchored" data-anchor-id="just-for-fun">Just for fun</h2>
<div class="sourceClojure">
<div class="sourceCode" id="cb78"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">for</span> [m (pgex/mandelbrot db)]</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  (<span class="at">:art</span> m))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb79"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>(<span class="st">"             ....................................................................................     "</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a> <span class="st">"            .......................................................................................   "</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a> <span class="st">"           .........................................................................................  "</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a> <span class="st">"          ........................................................................................... "</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a> <span class="st">"        ....................................................,,,,,,,,,................................."</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a> <span class="st">"       ................................................,,,,,,,,,,,,,,,,,,............................."</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a> <span class="st">"      ..............................................,,,,,,,,,,,,,,,,,,,,,,,,.........................."</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a> <span class="st">"     ............................................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,........................"</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a> <span class="st">"     ..........................................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,......................"</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a> <span class="st">"    .........................................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,...................."</span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a> <span class="st">"   ........................................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,..................."</span></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a> <span class="st">"  .......................................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,................."</span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a> <span class="st">" .......................................,,,,,,,,,,,,,,,,,,,,,,,,--,,,,,,,,,,,,,,,,,,,,................"</span></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a> <span class="st">"......................................,,,,,,,,,,,,,,,,,,,,,,,,,,-+--,,,,,,,,,,,,,,,,,,,..............."</span></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a> <span class="st">"....................................,,,,,,,,,,,,,,,,,,,,,,,,,,,,-----,,,,,,,,,,,,,,,,,,,.............."</span></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a> <span class="st">"...................................,,,,,,,,,,,,,,,,,,,,,,,,,,,,--- -----,,,,,,,,,,,,,,,,,............."</span></span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a> <span class="st">".................................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,---++--++,,,,,,,,,,,,,,,,,,............"</span></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a> <span class="st">"................................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,-----%++---,,,,,,,,,,,,,,,,,............"</span></span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a> <span class="st">"..............................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,-----+%----,,,,,,,,,,,,,,,,,,..........."</span></span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a> <span class="st">".............................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,----- %%+----,,,,,,,,,,,,,,,,,,.........."</span></span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a> <span class="st">"...........................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,---%-+%   ----,,,,,,,,,,,,,,,,,,,........."</span></span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a> <span class="st">"..........................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,---+ +##  %+%---,,,,,,,,,,,,,,,,,,........."</span></span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a> <span class="st">"........................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,-----#      # +---,,,,,,,,,,,,,,,,,,........"</span></span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a> <span class="st">".......................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,-------%       %-----,,,,,,,,,,,,,,,,,........"</span></span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a> <span class="st">".....................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,---------+         ------,,,,,,,,,,,,,,,,,......."</span></span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a> <span class="st">"....................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,-----------+@       +-----------,,,,,,,,,,,,......."</span></span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a> <span class="st">"..................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,----@-------++       ++-----------,,,,,,,,,,,,......"</span></span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a> <span class="st">".................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,--+@% ---+ +@%%@     %%+@+@%------+-,,,,,,,,,,,......"</span></span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a> <span class="st">"................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,----  # ++%               % @-----++--,,,,,,,,,,,....."</span></span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a> <span class="st">"..............,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,----+    %                  %%++ %+%@-,,,,,,,,,,,....."</span></span>
<span id="cb79-31"><a href="#cb79-31" aria-hidden="true" tabindex="-1"></a> <span class="st">".............,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,-----+#                       #%    ++-,,,,,,,,,,,,...."</span></span>
<span id="cb79-32"><a href="#cb79-32" aria-hidden="true" tabindex="-1"></a> <span class="st">"............,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,------+                             @---,,,,,,,,,,,,...."</span></span>
<span id="cb79-33"><a href="#cb79-33" aria-hidden="true" tabindex="-1"></a> <span class="st">"..........,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,-------++%                             ---,,,,,,,,,,,,...."</span></span>
<span id="cb79-34"><a href="#cb79-34" aria-hidden="true" tabindex="-1"></a> <span class="st">".........,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,--------+ +                             %+---,,,,,,,,,,,,,..."</span></span>
<span id="cb79-35"><a href="#cb79-35" aria-hidden="true" tabindex="-1"></a> <span class="st">"........,,,,,,,,,,,,,,,,,,,,,--------------------@                                +----,,,,,,,,,,,,..."</span></span>
<span id="cb79-36"><a href="#cb79-36" aria-hidden="true" tabindex="-1"></a> <span class="st">".......,,,,,,,,,,,,,,,,,,,,,,- +-----------------+                                 ----,,,,,,,,,,,,..."</span></span>
<span id="cb79-37"><a href="#cb79-37" aria-hidden="true" tabindex="-1"></a> <span class="st">".......,,,,,,,,,,,,,,,,,,,,,--++------+---------+%                                 +++--,,,,,,,,,,,,.."</span></span>
<span id="cb79-38"><a href="#cb79-38" aria-hidden="true" tabindex="-1"></a> <span class="st">"......,,,,,,,,,,,,,,,,,,,,,,--%+-----++---------                                     #+-,,,,,,,,,,,,.."</span></span>
<span id="cb79-39"><a href="#cb79-39" aria-hidden="true" tabindex="-1"></a> <span class="st">".....,,,,,,,,,,,,,,,,,,,,,,----#%++--+@ -+-----+%                                     --,,,,,,,,,,,,.."</span></span>
<span id="cb79-40"><a href="#cb79-40" aria-hidden="true" tabindex="-1"></a> <span class="st">".....,,,,,,,,,,,,,,,,,,,,,,-----+## ++@ + +----%                                    +--,,,,,,,,,,,,,.."</span></span>
<span id="cb79-41"><a href="#cb79-41" aria-hidden="true" tabindex="-1"></a> <span class="st">"....,,,,,,,,,,,,,,,,,,,,,,------+@  @     @@++++#                                   +--,,,,,,,,,,,,,.."</span></span>
<span id="cb79-42"><a href="#cb79-42" aria-hidden="true" tabindex="-1"></a> <span class="st">"....,,,,,,,,,,,,,,,,,,,,,-------%           #++%                                      -,,,,,,,,,,,,,.."</span></span>
<span id="cb79-43"><a href="#cb79-43" aria-hidden="true" tabindex="-1"></a> <span class="st">"...,,,,,,,,,,,,,,,,,,,,,------++%#           %%@                                     %-,,,,,,,,,,,,,,."</span></span>
<span id="cb79-44"><a href="#cb79-44" aria-hidden="true" tabindex="-1"></a> <span class="st">"...,,,,,,,,,,,,,,,,,,,--------+               %                                     +--,,,,,,,,,,,,,,."</span></span>
<span id="cb79-45"><a href="#cb79-45" aria-hidden="true" tabindex="-1"></a> <span class="st">"...,,,,,,,,,,,,,,,,,,-----+--++@              #                                      --,,,,,,,,,,,,,,."</span></span>
<span id="cb79-46"><a href="#cb79-46" aria-hidden="true" tabindex="-1"></a> <span class="st">"..,,,,,,,,,,,,,,,,,-------%+++%                                                    @--,,,,,,,,,,,,,,,."</span></span>
<span id="cb79-47"><a href="#cb79-47" aria-hidden="true" tabindex="-1"></a> <span class="st">"..,,,,,,,,,,,-------------+ @#@                                                    ---,,,,,,,,,,,,,,,."</span></span>
<span id="cb79-48"><a href="#cb79-48" aria-hidden="true" tabindex="-1"></a> <span class="st">"..,,,,,,,,,---@--------@-+%                                                       +---,,,,,,,,,,,,,,,."</span></span>
<span id="cb79-49"><a href="#cb79-49" aria-hidden="true" tabindex="-1"></a> <span class="st">"..,,,,,------- +-++++-+%%%                                                       +----,,,,,,,,,,,,,,,."</span></span>
<span id="cb79-50"><a href="#cb79-50" aria-hidden="true" tabindex="-1"></a> <span class="st">"..,,,,,,------%--------++%                                                       +----,,,,,,,,,,,,,,,."</span></span>
<span id="cb79-51"><a href="#cb79-51" aria-hidden="true" tabindex="-1"></a> <span class="st">"..,,,,,,,,,,--+----------++#                                                       ---,,,,,,,,,,,,,,,."</span></span>
<span id="cb79-52"><a href="#cb79-52" aria-hidden="true" tabindex="-1"></a> <span class="st">"..,,,,,,,,,,,,------------+@@@%                                                    +--,,,,,,,,,,,,,,,."</span></span>
<span id="cb79-53"><a href="#cb79-53" aria-hidden="true" tabindex="-1"></a> <span class="st">"..,,,,,,,,,,,,,,,,,------- +++%                                                    %--,,,,,,,,,,,,,,,."</span></span>
<span id="cb79-54"><a href="#cb79-54" aria-hidden="true" tabindex="-1"></a> <span class="st">"...,,,,,,,,,,,,,,,,,,---------+@              @                                      --,,,,,,,,,,,,,,."</span></span>
<span id="cb79-55"><a href="#cb79-55" aria-hidden="true" tabindex="-1"></a> <span class="st">"...,,,,,,,,,,,,,,,,,,,,------- #              %@                                    +--,,,,,,,,,,,,,,."</span></span>
<span id="cb79-56"><a href="#cb79-56" aria-hidden="true" tabindex="-1"></a> <span class="st">"...,,,,,,,,,,,,,,,,,,,,,-------++@           %+                                      %-,,,,,,,,,,,,,,."</span></span>
<span id="cb79-57"><a href="#cb79-57" aria-hidden="true" tabindex="-1"></a> <span class="st">"....,,,,,,,,,,,,,,,,,,,,,-------            %++%                                     %-,,,,,,,,,,,,,.."</span></span>
<span id="cb79-58"><a href="#cb79-58" aria-hidden="true" tabindex="-1"></a> <span class="st">"....,,,,,,,,,,,,,,,,,,,,,,------+#  %#   #@ ++++                                    +--,,,,,,,,,,,,,.."</span></span>
<span id="cb79-59"><a href="#cb79-59" aria-hidden="true" tabindex="-1"></a> <span class="st">".....,,,,,,,,,,,,,,,,,,,,,,-----+ %%++% +@+----+                                    +--,,,,,,,,,,,,,.."</span></span>
<span id="cb79-60"><a href="#cb79-60" aria-hidden="true" tabindex="-1"></a> <span class="st">".....,,,,,,,,,,,,,,,,,,,,,,,---%+++--+#+--------%                                    #--,,,,,,,,,,,,.."</span></span>
<span id="cb79-61"><a href="#cb79-61" aria-hidden="true" tabindex="-1"></a> <span class="st">"......,,,,,,,,,,,,,,,,,,,,,,--++-----%%---------                                    @#--,,,,,,,,,,,,.."</span></span>
<span id="cb79-62"><a href="#cb79-62" aria-hidden="true" tabindex="-1"></a> <span class="st">".......,,,,,,,,,,,,,,,,,,,,,---------------------+@                                +-++,,,,,,,,,,,,..."</span></span>
<span id="cb79-63"><a href="#cb79-63" aria-hidden="true" tabindex="-1"></a> <span class="st">"........,,,,,,,,,,,,,,,,,,,,,--------------------+                                 ----,,,,,,,,,,,,..."</span></span>
<span id="cb79-64"><a href="#cb79-64" aria-hidden="true" tabindex="-1"></a> <span class="st">".........,,,,,,,,,,,,,,,,,,,,----,,,-------------                                #+----,,,,,,,,,,,,..."</span></span>
<span id="cb79-65"><a href="#cb79-65" aria-hidden="true" tabindex="-1"></a> <span class="st">"..........,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,-------+ +                              +---,,,,,,,,,,,,,..."</span></span>
<span id="cb79-66"><a href="#cb79-66" aria-hidden="true" tabindex="-1"></a> <span class="st">"...........,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,--------+%#                           #---,,,,,,,,,,,,...."</span></span>
<span id="cb79-67"><a href="#cb79-67" aria-hidden="true" tabindex="-1"></a> <span class="st">"............,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,------+#                        @   @---,,,,,,,,,,,,...."</span></span>
<span id="cb79-68"><a href="#cb79-68" aria-hidden="true" tabindex="-1"></a> <span class="st">".............,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,-----+#                        +    @--,,,,,,,,,,,,...."</span></span>
<span id="cb79-69"><a href="#cb79-69" aria-hidden="true" tabindex="-1"></a> <span class="st">"..............,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,---+%   %+@                 %+-+ +++%-,,,,,,,,,,,....."</span></span>
<span id="cb79-70"><a href="#cb79-70" aria-hidden="true" tabindex="-1"></a> <span class="st">"................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,----% %@++              # %  -----++-,,,,,,,,,,,,....."</span></span>
<span id="cb79-71"><a href="#cb79-71" aria-hidden="true" tabindex="-1"></a> <span class="st">".................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,-- ++ ---+ + +%@     %++++++------%-,,,,,,,,,,,......"</span></span>
<span id="cb79-72"><a href="#cb79-72" aria-hidden="true" tabindex="-1"></a> <span class="st">"...................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,---- -------++       +------------,,,,,,,,,,,,......"</span></span>
<span id="cb79-73"><a href="#cb79-73" aria-hidden="true" tabindex="-1"></a> <span class="st">"....................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,-----------+%       +--------,,,,,,,,,,,,,,,......."</span></span>
<span id="cb79-74"><a href="#cb79-74" aria-hidden="true" tabindex="-1"></a> <span class="st">"......................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,--------+#        -----,,,,,,,,,,,,,,,,,,......."</span></span>
<span id="cb79-75"><a href="#cb79-75" aria-hidden="true" tabindex="-1"></a> <span class="st">".......................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,-------+       #----,,,,,,,,,,,,,,,,,,........"</span></span>
<span id="cb79-76"><a href="#cb79-76" aria-hidden="true" tabindex="-1"></a> <span class="st">".........................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,----+%      %#---,,,,,,,,,,,,,,,,,,,........"</span></span>
<span id="cb79-77"><a href="#cb79-77" aria-hidden="true" tabindex="-1"></a> <span class="st">"..........................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,---+%+%@  %+%%--,,,,,,,,,,,,,,,,,,........."</span></span>
<span id="cb79-78"><a href="#cb79-78" aria-hidden="true" tabindex="-1"></a> <span class="st">"............................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,---+-+%  %----,,,,,,,,,,,,,,,,,,.........."</span></span>
<span id="cb79-79"><a href="#cb79-79" aria-hidden="true" tabindex="-1"></a> <span class="st">".............................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,-----+%@+---,,,,,,,,,,,,,,,,,,,.........."</span></span>
<span id="cb79-80"><a href="#cb79-80" aria-hidden="true" tabindex="-1"></a> <span class="st">"...............................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,-----+%----,,,,,,,,,,,,,,,,,,..........."</span></span>
<span id="cb79-81"><a href="#cb79-81" aria-hidden="true" tabindex="-1"></a> <span class="st">"................................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,-----%+ +--,,,,,,,,,,,,,,,,,............"</span></span>
<span id="cb79-82"><a href="#cb79-82" aria-hidden="true" tabindex="-1"></a> <span class="st">"..................................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,---++----,,,,,,,,,,,,,,,,,............."</span></span>
<span id="cb79-83"><a href="#cb79-83" aria-hidden="true" tabindex="-1"></a> <span class="st">"...................................,,,,,,,,,,,,,,,,,,,,,,,,,,,,---@-----,,,,,,,,,,,,,,,,,............."</span></span>
<span id="cb79-84"><a href="#cb79-84" aria-hidden="true" tabindex="-1"></a> <span class="st">".....................................,,,,,,,,,,,,,,,,,,,,,,,,,,,-----,,,,,,,,,,,,,,,,,,,.............."</span></span>
<span id="cb79-85"><a href="#cb79-85" aria-hidden="true" tabindex="-1"></a> <span class="st">" .....................................,,,,,,,,,,,,,,,,,,,,,,,,,,--%,,,,,,,,,,,,,,,,,,,,..............."</span></span>
<span id="cb79-86"><a href="#cb79-86" aria-hidden="true" tabindex="-1"></a> <span class="st">" .......................................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,................."</span></span>
<span id="cb79-87"><a href="#cb79-87" aria-hidden="true" tabindex="-1"></a> <span class="st">"  ........................................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.................."</span></span>
<span id="cb79-88"><a href="#cb79-88" aria-hidden="true" tabindex="-1"></a> <span class="st">"   ........................................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,..................."</span></span>
<span id="cb79-89"><a href="#cb79-89" aria-hidden="true" tabindex="-1"></a> <span class="st">"    .........................................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,...................."</span></span>
<span id="cb79-90"><a href="#cb79-90" aria-hidden="true" tabindex="-1"></a> <span class="st">"     ..........................................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,......................"</span></span>
<span id="cb79-91"><a href="#cb79-91" aria-hidden="true" tabindex="-1"></a> <span class="st">"      ............................................,,,,,,,,,,,,,,,,,,,,,,,,,,,,........................"</span></span>
<span id="cb79-92"><a href="#cb79-92" aria-hidden="true" tabindex="-1"></a> <span class="st">"       .............................................,,,,,,,,,,,,,,,,,,,,,,,,.........................."</span></span>
<span id="cb79-93"><a href="#cb79-93" aria-hidden="true" tabindex="-1"></a> <span class="st">"        ................................................,,,,,,,,,,,,,,,,,............................."</span></span>
<span id="cb79-94"><a href="#cb79-94" aria-hidden="true" tabindex="-1"></a> <span class="st">"         .....................................................,,,,...................................."</span></span>
<span id="cb79-95"><a href="#cb79-95" aria-hidden="true" tabindex="-1"></a> <span class="st">"          ........................................................................................... "</span></span>
<span id="cb79-96"><a href="#cb79-96" aria-hidden="true" tabindex="-1"></a> <span class="st">"           .........................................................................................  "</span></span>
<span id="cb79-97"><a href="#cb79-97" aria-hidden="true" tabindex="-1"></a> <span class="st">"            ......................................................................................    "</span></span>
<span id="cb79-98"><a href="#cb79-98" aria-hidden="true" tabindex="-1"></a> <span class="st">"             ....................................................................................     "</span></span>
<span id="cb79-99"><a href="#cb79-99" aria-hidden="true" tabindex="-1"></a> <span class="st">"               .................................................................................      "</span></span>
<span id="cb79-100"><a href="#cb79-100" aria-hidden="true" tabindex="-1"></a> <span class="st">"                ..............................................................................        "</span></span>
<span id="cb79-101"><a href="#cb79-101" aria-hidden="true" tabindex="-1"></a> <span class="st">"                  ...........................................................................         "</span></span>
<span id="cb79-102"><a href="#cb79-102" aria-hidden="true" tabindex="-1"></a> <span class="st">"                   ........................................................................           "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="to-recreate-this-notebook" class="level2">
<h2 class="anchored" data-anchor-id="to-recreate-this-notebook">To recreate this notebook</h2>
<p>The contents of this <a href="https://github.com/perrygeo/postgres-extras-clj/blob/main/examples/pgbench_tutorial.clj">namespace</a> are periodically rendered and checked into main. Why not as part of the test suite? running a database to make a meaningful tutorial, with commentary about the results, is not trivial to automate.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb80"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">comment</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">require</span> '[scicloj.clay.v2.api <span class="at">:as</span> clay])</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  (clay/browse!)</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  (clay/make! {<span class="at">:source-path</span> <span class="st">"examples/pgbench_tutorial.clj"</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">:format</span> [<span class="at">:quarto</span> <span class="at">:html</span>]</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">:base-target-path</span> <span class="st">"examples/rendered"</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div style="background-color:grey;height:2px;width:100%;"></div>
<div><pre><small><small>source: examples/pgbench_tutorial.clj</small></small></pre></div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>